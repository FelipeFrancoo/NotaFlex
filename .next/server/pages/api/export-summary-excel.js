"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/export-summary-excel";
exports.ids = ["pages/api/export-summary-excel"];
exports.modules = {

/***/ "exceljs":
/*!**************************!*\
  !*** external "exceljs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("exceljs");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fexport-summary-excel&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cexport-summary-excel.ts&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fexport-summary-excel&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cexport-summary-excel.ts&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_export_summary_excel_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\export-summary-excel.ts */ \"(api)/./pages/api/export-summary-excel.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_export_summary_excel_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_export_summary_excel_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/export-summary-excel\",\n        pathname: \"/api/export-summary-excel\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_export_summary_excel_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmV4cG9ydC1zdW1tYXJ5LWV4Y2VsJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUNleHBvcnQtc3VtbWFyeS1leGNlbC50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUNrRTtBQUNsRTtBQUNBLGlFQUFlLHdFQUFLLENBQUMsK0RBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLCtEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovL25vdGFmbGV4LW5leHRqcy8/MTNhMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXGV4cG9ydC1zdW1tYXJ5LWV4Y2VsLnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZXhwb3J0LXN1bW1hcnktZXhjZWxcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9leHBvcnQtc3VtbWFyeS1leGNlbFwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fexport-summary-excel&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cexport-summary-excel.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/storage.ts":
/*!************************!*\
  !*** ./lib/storage.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   storage: () => (/* binding */ storage)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n// lib/storage.ts\n\n\nclass PersistentStorage {\n    constructor(){\n        this.data = {};\n        this.filePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"temp\", \"storage_cache.json\");\n        this.ensureDirectoryExists();\n        this.loadFromFile();\n    }\n    ensureDirectoryExists() {\n        const dir = path__WEBPACK_IMPORTED_MODULE_1___default().dirname(this.filePath);\n        if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(dir)) {\n            fs__WEBPACK_IMPORTED_MODULE_0___default().mkdirSync(dir, {\n                recursive: true\n            });\n        }\n    }\n    loadFromFile() {\n        try {\n            if (fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(this.filePath)) {\n                const content = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(this.filePath, \"utf-8\");\n                this.data = JSON.parse(content);\n                console.log(\"[STORAGE] Dados carregados do cache:\", Object.keys(this.data));\n            }\n        } catch (error) {\n            console.warn(\"[STORAGE] Erro ao carregar cache:\", error);\n            this.data = {};\n        }\n    }\n    saveToFile() {\n        try {\n            fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(this.filePath, JSON.stringify(this.data, null, 2));\n            console.log(\"[STORAGE] Dados salvos no cache:\", Object.keys(this.data));\n        } catch (error) {\n            console.warn(\"[STORAGE] Erro ao salvar cache:\", error);\n        }\n    }\n    get(key) {\n        return this.data[key];\n    }\n    set(key, value) {\n        this.data[key] = value;\n        this.saveToFile();\n        console.log(`[STORAGE] Definido ${key}:`, typeof value === \"object\" ? JSON.stringify(value).substring(0, 100) + \"...\" : value);\n    }\n    delete(key) {\n        delete this.data[key];\n        this.saveToFile();\n    }\n    keys() {\n        return Object.keys(this.data);\n    }\n    clear() {\n        this.data = {};\n        this.saveToFile();\n    }\n}\n// Criar instância singleton\nconst persistentStorage = new PersistentStorage();\n// Proxy para manter compatibilidade com sintaxe de array\nconst storage = new Proxy(persistentStorage, {\n    get (target, prop) {\n        if (typeof prop === \"string\") {\n            // Se for um método da classe, retornar o método\n            if (typeof target[prop] === \"function\") {\n                return target[prop].bind(target);\n            }\n            // Caso contrário, tratar como chave de dados\n            return target.get(prop);\n        }\n        return target[prop];\n    },\n    set (target, prop, value) {\n        if (typeof prop === \"string\") {\n            target.set(prop, value);\n            return true;\n        }\n        return false;\n    },\n    deleteProperty (target, prop) {\n        if (typeof prop === \"string\") {\n            target.delete(prop);\n            return true;\n        }\n        return false;\n    },\n    ownKeys (target) {\n        return target.keys();\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjtJQUNBVCxLQUFJUSxNQUFNLEVBQUVDLElBQXFCLEVBQUVSLEtBQUs7UUFDdEMsSUFBSSxPQUFPUSxTQUFTLFVBQVU7WUFDNUJELE9BQU9SLEdBQUcsQ0FBQ1MsTUFBTVI7WUFDakIsT0FBTztRQUNUO1FBQ0EsT0FBTztJQUNUO0lBQ0FVLGdCQUFlSCxNQUFNLEVBQUVDLElBQXFCO1FBQzFDLElBQUksT0FBT0EsU0FBUyxVQUFVO1lBQzVCRCxPQUFPTCxNQUFNLENBQUNNO1lBQ2QsT0FBTztRQUNUO1FBQ0EsT0FBTztJQUNUO0lBQ0FHLFNBQVFKLE1BQU07UUFDWixPQUFPQSxPQUFPaEIsSUFBSTtJQUNwQjtBQUNGLEdBQUciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ub3RhZmxleC1uZXh0anMvLi9saWIvc3RvcmFnZS50cz81ZGM4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpYi9zdG9yYWdlLnRzXHJcbmltcG9ydCBmcyBmcm9tICdmcyc7XHJcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xyXG5cclxuaW50ZXJmYWNlIFN0b3JhZ2VEYXRhIHtcclxuICBba2V5OiBzdHJpbmddOiBhbnk7XHJcbn1cclxuXHJcbmNsYXNzIFBlcnNpc3RlbnRTdG9yYWdlIHtcclxuICBwcml2YXRlIGRhdGE6IFN0b3JhZ2VEYXRhID0ge307XHJcbiAgcHJpdmF0ZSBmaWxlUGF0aDogc3RyaW5nO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuZmlsZVBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3RlbXAnLCAnc3RvcmFnZV9jYWNoZS5qc29uJyk7XHJcbiAgICB0aGlzLmVuc3VyZURpcmVjdG9yeUV4aXN0cygpO1xyXG4gICAgdGhpcy5sb2FkRnJvbUZpbGUoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZW5zdXJlRGlyZWN0b3J5RXhpc3RzKCkge1xyXG4gICAgY29uc3QgZGlyID0gcGF0aC5kaXJuYW1lKHRoaXMuZmlsZVBhdGgpO1xyXG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKGRpcikpIHtcclxuICAgICAgZnMubWtkaXJTeW5jKGRpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGxvYWRGcm9tRmlsZSgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKHRoaXMuZmlsZVBhdGgpKSB7XHJcbiAgICAgICAgY29uc3QgY29udGVudCA9IGZzLnJlYWRGaWxlU3luYyh0aGlzLmZpbGVQYXRoLCAndXRmLTgnKTtcclxuICAgICAgICB0aGlzLmRhdGEgPSBKU09OLnBhcnNlKGNvbnRlbnQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbU1RPUkFHRV0gRGFkb3MgY2FycmVnYWRvcyBkbyBjYWNoZTonLCBPYmplY3Qua2V5cyh0aGlzLmRhdGEpKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS53YXJuKCdbU1RPUkFHRV0gRXJybyBhbyBjYXJyZWdhciBjYWNoZTonLCBlcnJvcik7XHJcbiAgICAgIHRoaXMuZGF0YSA9IHt9O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzYXZlVG9GaWxlKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgZnMud3JpdGVGaWxlU3luYyh0aGlzLmZpbGVQYXRoLCBKU09OLnN0cmluZ2lmeSh0aGlzLmRhdGEsIG51bGwsIDIpKTtcclxuICAgICAgY29uc29sZS5sb2coJ1tTVE9SQUdFXSBEYWRvcyBzYWx2b3Mgbm8gY2FjaGU6JywgT2JqZWN0LmtleXModGhpcy5kYXRhKSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ1tTVE9SQUdFXSBFcnJvIGFvIHNhbHZhciBjYWNoZTonLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXQoa2V5OiBzdHJpbmcpIHtcclxuICAgIHJldHVybiB0aGlzLmRhdGFba2V5XTtcclxuICB9XHJcblxyXG4gIHNldChrZXk6IHN0cmluZywgdmFsdWU6IGFueSkge1xyXG4gICAgdGhpcy5kYXRhW2tleV0gPSB2YWx1ZTtcclxuICAgIHRoaXMuc2F2ZVRvRmlsZSgpO1xyXG4gICAgY29uc29sZS5sb2coYFtTVE9SQUdFXSBEZWZpbmlkbyAke2tleX06YCwgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyA/IEpTT04uc3RyaW5naWZ5KHZhbHVlKS5zdWJzdHJpbmcoMCwgMTAwKSArICcuLi4nIDogdmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlKGtleTogc3RyaW5nKSB7XHJcbiAgICBkZWxldGUgdGhpcy5kYXRhW2tleV07XHJcbiAgICB0aGlzLnNhdmVUb0ZpbGUoKTtcclxuICB9XHJcblxyXG4gIGtleXMoKSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5kYXRhKTtcclxuICB9XHJcblxyXG4gIGNsZWFyKCkge1xyXG4gICAgdGhpcy5kYXRhID0ge307XHJcbiAgICB0aGlzLnNhdmVUb0ZpbGUoKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIENyaWFyIGluc3TDom5jaWEgc2luZ2xldG9uXHJcbmNvbnN0IHBlcnNpc3RlbnRTdG9yYWdlID0gbmV3IFBlcnNpc3RlbnRTdG9yYWdlKCk7XHJcblxyXG4vLyBQcm94eSBwYXJhIG1hbnRlciBjb21wYXRpYmlsaWRhZGUgY29tIHNpbnRheGUgZGUgYXJyYXlcclxuZXhwb3J0IGNvbnN0IHN0b3JhZ2UgPSBuZXcgUHJveHkocGVyc2lzdGVudFN0b3JhZ2UsIHtcclxuICBnZXQodGFyZ2V0LCBwcm9wOiBzdHJpbmcgfCBzeW1ib2wpIHtcclxuICAgIGlmICh0eXBlb2YgcHJvcCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgLy8gU2UgZm9yIHVtIG3DqXRvZG8gZGEgY2xhc3NlLCByZXRvcm5hciBvIG3DqXRvZG9cclxuICAgICAgaWYgKHR5cGVvZiAodGFyZ2V0IGFzIGFueSlbcHJvcF0gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICByZXR1cm4gKHRhcmdldCBhcyBhbnkpW3Byb3BdLmJpbmQodGFyZ2V0KTtcclxuICAgICAgfVxyXG4gICAgICAvLyBDYXNvIGNvbnRyw6FyaW8sIHRyYXRhciBjb21vIGNoYXZlIGRlIGRhZG9zXHJcbiAgICAgIHJldHVybiB0YXJnZXQuZ2V0KHByb3ApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICh0YXJnZXQgYXMgYW55KVtwcm9wXTtcclxuICB9LFxyXG4gIHNldCh0YXJnZXQsIHByb3A6IHN0cmluZyB8IHN5bWJvbCwgdmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgcHJvcCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgdGFyZ2V0LnNldChwcm9wLCB2YWx1ZSk7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH0sXHJcbiAgZGVsZXRlUHJvcGVydHkodGFyZ2V0LCBwcm9wOiBzdHJpbmcgfCBzeW1ib2wpIHtcclxuICAgIGlmICh0eXBlb2YgcHJvcCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgdGFyZ2V0LmRlbGV0ZShwcm9wKTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfSxcclxuICBvd25LZXlzKHRhcmdldCkge1xyXG4gICAgcmV0dXJuIHRhcmdldC5rZXlzKCk7XHJcbiAgfVxyXG59KTtcclxuIl0sIm5hbWVzIjpbImZzIiwicGF0aCIsIlBlcnNpc3RlbnRTdG9yYWdlIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiZmlsZVBhdGgiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImVuc3VyZURpcmVjdG9yeUV4aXN0cyIsImxvYWRGcm9tRmlsZSIsImRpciIsImRpcm5hbWUiLCJleGlzdHNTeW5jIiwibWtkaXJTeW5jIiwicmVjdXJzaXZlIiwiY29udGVudCIsInJlYWRGaWxlU3luYyIsIkpTT04iLCJwYXJzZSIsImNvbnNvbGUiLCJsb2ciLCJPYmplY3QiLCJrZXlzIiwiZXJyb3IiLCJ3YXJuIiwic2F2ZVRvRmlsZSIsIndyaXRlRmlsZVN5bmMiLCJzdHJpbmdpZnkiLCJnZXQiLCJrZXkiLCJzZXQiLCJ2YWx1ZSIsInN1YnN0cmluZyIsImRlbGV0ZSIsImNsZWFyIiwicGVyc2lzdGVudFN0b3JhZ2UiLCJzdG9yYWdlIiwiUHJveHkiLCJ0YXJnZXQiLCJwcm9wIiwiYmluZCIsImRlbGV0ZVByb3BlcnR5Iiwib3duS2V5cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/storage.ts\n");

/***/ }),

/***/ "(api)/./pages/api/export-summary-excel.ts":
/*!*******************************************!*\
  !*** ./pages/api/export-summary-excel.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var exceljs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! exceljs */ \"exceljs\");\n/* harmony import */ var exceljs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(exceljs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_storage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../lib/storage */ \"(api)/./lib/storage.ts\");\n\n\nasync function handler(req, res) {\n    if (req.method !== \"GET\") {\n        return res.status(405).json({\n            error: \"M\\xe9todo n\\xe3o permitido\"\n        });\n    }\n    try {\n        console.log(\"[EXPORT] Iniciando exporta\\xe7\\xe3o Excel\");\n        console.log(\"[EXPORT] Storage keys:\", _lib_storage__WEBPACK_IMPORTED_MODULE_1__.storage.keys());\n        console.log(\"[EXPORT] Storage summaryData exists:\", !!_lib_storage__WEBPACK_IMPORTED_MODULE_1__.storage.get(\"summaryData\"));\n        const summaryData = _lib_storage__WEBPACK_IMPORTED_MODULE_1__.storage.get(\"summaryData\");\n        if (!summaryData) {\n            console.log(\"[EXPORT] Nenhum dados encontrado no storage\");\n            return res.status(400).json({\n                error: \"Nenhum dado de resumo encontrado. Fa\\xe7a upload dos arquivos CSV primeiro.\",\n                debug: {\n                    storageKeys: _lib_storage__WEBPACK_IMPORTED_MODULE_1__.storage.keys(),\n                    hasData: !!summaryData\n                }\n            });\n        }\n        console.log(\"[EXPORT] SummaryData encontrado:\", {\n            branches: summaryData.branches?.length || 0,\n            dateSpecificTotals: summaryData.dateSpecificTotals?.length || 0,\n            grandTotal: summaryData.grandTotal\n        });\n        const workbook = new (exceljs__WEBPACK_IMPORTED_MODULE_0___default().Workbook)();\n        const sheet = workbook.addWorksheet(\"Resumo Total das Filiais\"); // ESTILOS PADRONIZADOS OBRIGATÓRIOS\n        const headerStyle = {\n            font: {\n                bold: true,\n                color: {\n                    argb: \"FFFFFF\"\n                }\n            },\n            fill: {\n                type: \"pattern\",\n                pattern: \"solid\",\n                fgColor: {\n                    argb: \"2F5597\"\n                }\n            },\n            alignment: {\n                horizontal: \"center\",\n                vertical: \"middle\"\n            },\n            border: {\n                top: {\n                    style: \"thin\"\n                },\n                left: {\n                    style: \"thin\"\n                },\n                bottom: {\n                    style: \"thin\"\n                },\n                right: {\n                    style: \"thin\"\n                }\n            }\n        };\n        const cellStyle = {\n            border: {\n                top: {\n                    style: \"thin\"\n                },\n                left: {\n                    style: \"thin\"\n                },\n                bottom: {\n                    style: \"thin\"\n                },\n                right: {\n                    style: \"thin\"\n                }\n            },\n            fill: {\n                type: \"pattern\",\n                pattern: \"solid\",\n                fgColor: {\n                    argb: \"F8F9FA\"\n                }\n            }\n        };\n        const titleStyle = {\n            font: {\n                bold: true,\n                size: 16,\n                color: {\n                    argb: \"FFFFFF\"\n                }\n            },\n            alignment: {\n                horizontal: \"center\",\n                vertical: \"middle\"\n            },\n            fill: {\n                type: \"pattern\",\n                pattern: \"solid\",\n                fgColor: {\n                    argb: \"2F5597\"\n                }\n            }\n        };\n        let currentRow = 1;\n        // SEÇÃO 1: TÍTULO\n        sheet.addRow([\n            \"RESUMO TOTAL DAS FILIAIS\",\n            \"\"\n        ]);\n        sheet.mergeCells(`A${currentRow}:B${currentRow}`);\n        sheet.getCell(`A${currentRow}`).style = titleStyle;\n        sheet.getRow(currentRow).height = 35;\n        currentRow += 1; // Pular apenas 1 linha\n        // SEÇÃO 2: DADOS DAS FILIAIS\n        sheet.addRow([\n            \"Filial\",\n            \"Total A Pagar\"\n        ]);\n        sheet.getRow(currentRow).eachCell((cell, colNumber)=>{\n            if (colNumber <= 2) cell.style = headerStyle;\n        });\n        currentRow++;\n        // Dados das filiais\n        for (const branch of summaryData.branches || []){\n            sheet.addRow([\n                branch.name,\n                branch.totalAPagar || 0\n            ]);\n            const row = sheet.getRow(currentRow);\n            row.eachCell((cell, colNumber)=>{\n                if (colNumber <= 2) {\n                    cell.style = cellStyle;\n                    if (colNumber === 2) cell.numFmt = \"R$ #,##0.00\";\n                }\n            });\n            currentRow++;\n        }\n        // Linha de subtotal das filiais\n        if (summaryData.branches && summaryData.branches.length > 0) {\n            const subtotalRow = sheet.addRow([\n                \"TOTAL FILIAIS\",\n                summaryData.grandTotalAPagar || 0\n            ]);\n            subtotalRow.eachCell((cell, colNumber)=>{\n                if (colNumber <= 2) {\n                    cell.style = {\n                        font: {\n                            bold: true,\n                            color: {\n                                argb: \"FFFFFF\"\n                            }\n                        },\n                        fill: {\n                            type: \"pattern\",\n                            pattern: \"solid\",\n                            fgColor: {\n                                argb: \"2F5597\"\n                            }\n                        },\n                        border: {\n                            top: {\n                                style: \"thin\"\n                            },\n                            left: {\n                                style: \"thin\"\n                            },\n                            bottom: {\n                                style: \"thin\"\n                            },\n                            right: {\n                                style: \"thin\"\n                            }\n                        },\n                        alignment: {\n                            horizontal: \"center\",\n                            vertical: \"middle\"\n                        }\n                    };\n                    if (colNumber === 2) cell.numFmt = \"R$ #,##0.00\";\n                }\n            });\n            subtotalRow.height = 22;\n            currentRow = subtotalRow.number + 1; // Próxima linha após subtotal\n            // Adiciona UMA linha em branco de espaçamento\n            const blankAfterSubtotal = sheet.addRow([\n                \"\",\n                \"\"\n            ]);\n            currentRow = blankAfterSubtotal.number + 1;\n        }\n        // SEÇÃO 3: TOTAIS POR DATA (SE DISPONÍVEL)\n        if (summaryData.dateSpecificTotals && summaryData.dateSpecificTotals.length > 0) {\n            console.log(\"[EXPORT] Adicionando se\\xe7\\xe3o TOTAL POR DIA DA SEMANA\");\n            // Cria diretamente a linha de cabeçalho (sem deslocamento incorreto)\n            const headerRow = sheet.addRow([\n                \"TOTAL POR DIA DA SEMANA\",\n                \"Total\"\n            ]);\n            headerRow.eachCell((cell, colNumber)=>{\n                if (colNumber <= 2) cell.style = headerStyle;\n            });\n            headerRow.height = 25;\n            currentRow = headerRow.number + 1;\n            // Ordenar datas cronologicamente\n            const sortedDateTotals = [\n                ...summaryData.dateSpecificTotals\n            ].sort((a, b)=>{\n                const parseDate = (dateStr)=>{\n                    const parts = dateStr.split(\"/\");\n                    return new Date(parseInt(parts[2]), parseInt(parts[1]) - 1, parseInt(parts[0]));\n                };\n                return parseDate(a.day).getTime() - parseDate(b.day).getTime();\n            });\n            let consolidatedGrandTotal = 0;\n            // Adicionar dados das datas com dia da semana\n            for (const dateData of sortedDateTotals){\n                const parts = dateData.day.split(\"/\");\n                let dayOfWeek = \"\";\n                if (parts.length === 3) {\n                    const date = new Date(parseInt(parts[2]), parseInt(parts[1]) - 1, parseInt(parts[0]));\n                    const dayNames = [\n                        \"Domingo\",\n                        \"Segunda\",\n                        \"Ter\\xe7a\",\n                        \"Quarta\",\n                        \"Quinta\",\n                        \"Sexta\",\n                        \"S\\xe1bado\"\n                    ];\n                    dayOfWeek = dayNames[date.getDay()];\n                }\n                const dateWithDay = dayOfWeek ? `${dateData.day} (${dayOfWeek})` : dateData.day;\n                const dataRow = sheet.addRow([\n                    dateWithDay,\n                    dateData.total\n                ]);\n                dataRow.eachCell((cell, colNumber)=>{\n                    if (colNumber <= 2) {\n                        cell.style = cellStyle;\n                        if (colNumber === 2) cell.numFmt = \"R$ #,##0.00\";\n                    }\n                });\n                consolidatedGrandTotal += dateData.total;\n                currentRow = dataRow.number + 1;\n            }\n            // TOTAL GERAL FINAL\n            const consolidatedTotalRow = sheet.addRow([\n                \"TOTAL GERAL (Datas)\",\n                consolidatedGrandTotal\n            ]);\n            consolidatedTotalRow.eachCell((cell, colNumber)=>{\n                if (colNumber <= 2) {\n                    cell.style = {\n                        font: {\n                            bold: true,\n                            color: {\n                                argb: \"FFFFFF\"\n                            }\n                        },\n                        fill: {\n                            type: \"pattern\",\n                            pattern: \"solid\",\n                            fgColor: {\n                                argb: \"2F5597\"\n                            }\n                        },\n                        border: {\n                            top: {\n                                style: \"thin\"\n                            },\n                            left: {\n                                style: \"thin\"\n                            },\n                            bottom: {\n                                style: \"thin\"\n                            },\n                            right: {\n                                style: \"thin\"\n                            }\n                        },\n                        alignment: {\n                            horizontal: \"center\",\n                            vertical: \"middle\"\n                        }\n                    };\n                    if (colNumber === 2) cell.numFmt = \"R$ #,##0.00\";\n                }\n            });\n        }\n        // CONFIGURAÇÃO DE LARGURAS DAS COLUNAS\n        sheet.getColumn(1).width = 35; // Filial\n        sheet.getColumn(2).width = 22; // Total A Pagar\n        // HEADERS DE RESPOSTA PARA DOWNLOAD\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\n        res.setHeader(\"Content-Disposition\", `attachment; filename=\"resumo_total_filiais_${new Date().toISOString().split(\"T\")[0]}.xlsx\"`);\n        // ESCRITA E ENVIO DO ARQUIVO\n        await workbook.xlsx.write(res);\n        res.end();\n    } catch (error) {\n        console.error(\"Erro na exporta\\xe7\\xe3o do resumo Excel:\", error);\n        res.status(500).json({\n            error: \"Erro interno do servidor\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUl5RixHQUFHO0lBRVQsRUFBRSxPQUFPckYsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsNkNBQXVDQTtRQUNyREosSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQTJCO0lBQzNEO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ub3RhZmxleC1uZXh0anMvLi9wYWdlcy9hcGkvZXhwb3J0LXN1bW1hcnktZXhjZWwudHM/OTY4YyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XHJcbmltcG9ydCBFeGNlbEpTIGZyb20gJ2V4Y2VsanMnO1xyXG5pbXBvcnQgeyBzdG9yYWdlIH0gZnJvbSAnLi4vLi4vbGliL3N0b3JhZ2UnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xyXG4gIGlmIChyZXEubWV0aG9kICE9PSAnR0VUJykge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6ICdNw6l0b2RvIG7Do28gcGVybWl0aWRvJyB9KTtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZygnW0VYUE9SVF0gSW5pY2lhbmRvIGV4cG9ydGHDp8OjbyBFeGNlbCcpO1xyXG4gICAgY29uc29sZS5sb2coJ1tFWFBPUlRdIFN0b3JhZ2Uga2V5czonLCBzdG9yYWdlLmtleXMoKSk7XHJcbiAgICBjb25zb2xlLmxvZygnW0VYUE9SVF0gU3RvcmFnZSBzdW1tYXJ5RGF0YSBleGlzdHM6JywgISFzdG9yYWdlLmdldCgnc3VtbWFyeURhdGEnKSk7XHJcbiAgICBcclxuICAgIGNvbnN0IHN1bW1hcnlEYXRhID0gc3RvcmFnZS5nZXQoJ3N1bW1hcnlEYXRhJyk7XHJcbiAgICBcclxuICAgIGlmICghc3VtbWFyeURhdGEpIHtcclxuICAgICAgY29uc29sZS5sb2coJ1tFWFBPUlRdIE5lbmh1bSBkYWRvcyBlbmNvbnRyYWRvIG5vIHN0b3JhZ2UnKTtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXHJcbiAgICAgICAgZXJyb3I6ICdOZW5odW0gZGFkbyBkZSByZXN1bW8gZW5jb250cmFkby4gRmHDp2EgdXBsb2FkIGRvcyBhcnF1aXZvcyBDU1YgcHJpbWVpcm8uJyxcclxuICAgICAgICBkZWJ1Zzoge1xyXG4gICAgICAgICAgc3RvcmFnZUtleXM6IHN0b3JhZ2Uua2V5cygpLFxyXG4gICAgICAgICAgaGFzRGF0YTogISFzdW1tYXJ5RGF0YVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coJ1tFWFBPUlRdIFN1bW1hcnlEYXRhIGVuY29udHJhZG86Jywge1xyXG4gICAgICBicmFuY2hlczogc3VtbWFyeURhdGEuYnJhbmNoZXM/Lmxlbmd0aCB8fCAwLFxyXG4gICAgICBkYXRlU3BlY2lmaWNUb3RhbHM6IHN1bW1hcnlEYXRhLmRhdGVTcGVjaWZpY1RvdGFscz8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgIGdyYW5kVG90YWw6IHN1bW1hcnlEYXRhLmdyYW5kVG90YWxcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IHdvcmtib29rID0gbmV3IEV4Y2VsSlMuV29ya2Jvb2soKTtcclxuICAgIGNvbnN0IHNoZWV0ID0gd29ya2Jvb2suYWRkV29ya3NoZWV0KCdSZXN1bW8gVG90YWwgZGFzIEZpbGlhaXMnKTsgICAgLy8gRVNUSUxPUyBQQURST05JWkFET1MgT0JSSUdBVMOTUklPU1xyXG4gICAgY29uc3QgaGVhZGVyU3R5bGUgPSB7XHJcbiAgICAgIGZvbnQ6IHsgYm9sZDogdHJ1ZSwgY29sb3I6IHsgYXJnYjogJ0ZGRkZGRicgfSB9LFxyXG4gICAgICBmaWxsOiB7IHR5cGU6ICdwYXR0ZXJuJyBhcyBjb25zdCwgcGF0dGVybjogJ3NvbGlkJyBhcyBjb25zdCwgZmdDb2xvcjogeyBhcmdiOiAnMkY1NTk3JyB9IH0sXHJcbiAgICAgIGFsaWdubWVudDogeyBob3Jpem9udGFsOiAnY2VudGVyJyBhcyBjb25zdCwgdmVydGljYWw6ICdtaWRkbGUnIGFzIGNvbnN0IH0sXHJcbiAgICAgIGJvcmRlcjoge1xyXG4gICAgICAgIHRvcDogeyBzdHlsZTogJ3RoaW4nIGFzIGNvbnN0IH0sIGxlZnQ6IHsgc3R5bGU6ICd0aGluJyBhcyBjb25zdCB9LFxyXG4gICAgICAgIGJvdHRvbTogeyBzdHlsZTogJ3RoaW4nIGFzIGNvbnN0IH0sIHJpZ2h0OiB7IHN0eWxlOiAndGhpbicgYXMgY29uc3QgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGNlbGxTdHlsZSA9IHtcclxuICAgICAgYm9yZGVyOiB7XHJcbiAgICAgICAgdG9wOiB7IHN0eWxlOiAndGhpbicgYXMgY29uc3QgfSwgbGVmdDogeyBzdHlsZTogJ3RoaW4nIGFzIGNvbnN0IH0sXHJcbiAgICAgICAgYm90dG9tOiB7IHN0eWxlOiAndGhpbicgYXMgY29uc3QgfSwgcmlnaHQ6IHsgc3R5bGU6ICd0aGluJyBhcyBjb25zdCB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGZpbGw6IHsgdHlwZTogJ3BhdHRlcm4nIGFzIGNvbnN0LCBwYXR0ZXJuOiAnc29saWQnIGFzIGNvbnN0LCBmZ0NvbG9yOiB7IGFyZ2I6ICdGOEY5RkEnIH0gfVxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCB0aXRsZVN0eWxlID0ge1xyXG4gICAgICBmb250OiB7IGJvbGQ6IHRydWUsIHNpemU6IDE2LCBjb2xvcjogeyBhcmdiOiAnRkZGRkZGJyB9IH0sXHJcbiAgICAgIGFsaWdubWVudDogeyBob3Jpem9udGFsOiAnY2VudGVyJyBhcyBjb25zdCwgdmVydGljYWw6ICdtaWRkbGUnIGFzIGNvbnN0IH0sXHJcbiAgICAgIGZpbGw6IHsgdHlwZTogJ3BhdHRlcm4nIGFzIGNvbnN0LCBwYXR0ZXJuOiAnc29saWQnIGFzIGNvbnN0LCBmZ0NvbG9yOiB7IGFyZ2I6ICcyRjU1OTcnIH0gfVxyXG4gICAgfTtcclxuXHJcbiAgICBsZXQgY3VycmVudFJvdyA9IDE7XHJcblxyXG4gICAgLy8gU0XDh8ODTyAxOiBUw41UVUxPXHJcbiAgICBzaGVldC5hZGRSb3coWydSRVNVTU8gVE9UQUwgREFTIEZJTElBSVMnLCAnJ10pO1xyXG4gICAgc2hlZXQubWVyZ2VDZWxscyhgQSR7Y3VycmVudFJvd306QiR7Y3VycmVudFJvd31gKTtcclxuICAgIHNoZWV0LmdldENlbGwoYEEke2N1cnJlbnRSb3d9YCkuc3R5bGUgPSB0aXRsZVN0eWxlO1xyXG4gICAgc2hlZXQuZ2V0Um93KGN1cnJlbnRSb3cpLmhlaWdodCA9IDM1O1xyXG4gICAgY3VycmVudFJvdyArPSAxOyAvLyBQdWxhciBhcGVuYXMgMSBsaW5oYVxyXG5cclxuICAgIC8vIFNFw4fDg08gMjogREFET1MgREFTIEZJTElBSVNcclxuICAgIHNoZWV0LmFkZFJvdyhbJ0ZpbGlhbCcsICdUb3RhbCBBIFBhZ2FyJ10pO1xyXG4gICAgc2hlZXQuZ2V0Um93KGN1cnJlbnRSb3cpLmVhY2hDZWxsKChjZWxsLCBjb2xOdW1iZXIpID0+IHtcclxuICAgICAgaWYgKGNvbE51bWJlciA8PSAyKSBjZWxsLnN0eWxlID0gaGVhZGVyU3R5bGU7XHJcbiAgICB9KTtcclxuICAgIGN1cnJlbnRSb3crKztcclxuXHJcbiAgICAvLyBEYWRvcyBkYXMgZmlsaWFpc1xyXG4gICAgZm9yIChjb25zdCBicmFuY2ggb2Ygc3VtbWFyeURhdGEuYnJhbmNoZXMgfHwgW10pIHtcclxuICAgICAgc2hlZXQuYWRkUm93KFticmFuY2gubmFtZSwgYnJhbmNoLnRvdGFsQVBhZ2FyIHx8IDBdKTtcclxuICAgICAgY29uc3Qgcm93ID0gc2hlZXQuZ2V0Um93KGN1cnJlbnRSb3cpO1xyXG4gICAgICByb3cuZWFjaENlbGwoKGNlbGwsIGNvbE51bWJlcikgPT4ge1xyXG4gICAgICAgIGlmIChjb2xOdW1iZXIgPD0gMikge1xyXG4gICAgICAgICAgY2VsbC5zdHlsZSA9IGNlbGxTdHlsZTtcclxuICAgICAgICAgIGlmIChjb2xOdW1iZXIgPT09IDIpIGNlbGwubnVtRm10ID0gJ1IkICMsIyMwLjAwJztcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICBjdXJyZW50Um93Kys7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTGluaGEgZGUgc3VidG90YWwgZGFzIGZpbGlhaXNcclxuICAgIGlmIChzdW1tYXJ5RGF0YS5icmFuY2hlcyAmJiBzdW1tYXJ5RGF0YS5icmFuY2hlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnN0IHN1YnRvdGFsUm93ID0gc2hlZXQuYWRkUm93KFtcclxuICAgICAgICAnVE9UQUwgRklMSUFJUycsXHJcbiAgICAgICAgc3VtbWFyeURhdGEuZ3JhbmRUb3RhbEFQYWdhciB8fCAwXHJcbiAgICAgIF0pO1xyXG4gICAgICBzdWJ0b3RhbFJvdy5lYWNoQ2VsbCgoY2VsbCwgY29sTnVtYmVyKSA9PiB7XHJcbiAgICAgICAgaWYgKGNvbE51bWJlciA8PSAyKSB7XHJcbiAgICAgICAgICBjZWxsLnN0eWxlID0ge1xyXG4gICAgICAgICAgICBmb250OiB7IGJvbGQ6IHRydWUsIGNvbG9yOiB7IGFyZ2I6ICdGRkZGRkYnIH0gfSxcclxuICAgICAgICAgICAgZmlsbDogeyB0eXBlOiAncGF0dGVybicsIHBhdHRlcm46ICdzb2xpZCcsIGZnQ29sb3I6IHsgYXJnYjogJzJGNTU5NycgfSB9LFxyXG4gICAgICAgICAgICBib3JkZXI6IHtcclxuICAgICAgICAgICAgICB0b3A6IHsgc3R5bGU6ICd0aGluJyB9LCBsZWZ0OiB7IHN0eWxlOiAndGhpbicgfSxcclxuICAgICAgICAgICAgICBib3R0b206IHsgc3R5bGU6ICd0aGluJyB9LCByaWdodDogeyBzdHlsZTogJ3RoaW4nIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYWxpZ25tZW50OiB7IGhvcml6b250YWw6ICdjZW50ZXInLCB2ZXJ0aWNhbDogJ21pZGRsZScgfVxyXG4gICAgICAgICAgfSBhcyBhbnk7XHJcbiAgICAgICAgICBpZiAoY29sTnVtYmVyID09PSAyKSBjZWxsLm51bUZtdCA9ICdSJCAjLCMjMC4wMCc7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgc3VidG90YWxSb3cuaGVpZ2h0ID0gMjI7XHJcbiAgICAgIGN1cnJlbnRSb3cgPSBzdWJ0b3RhbFJvdy5udW1iZXIgKyAxOyAvLyBQcsOzeGltYSBsaW5oYSBhcMOzcyBzdWJ0b3RhbFxyXG4gICAgICAvLyBBZGljaW9uYSBVTUEgbGluaGEgZW0gYnJhbmNvIGRlIGVzcGHDp2FtZW50b1xyXG4gICAgICBjb25zdCBibGFua0FmdGVyU3VidG90YWwgPSBzaGVldC5hZGRSb3coWycnLCAnJ10pO1xyXG4gICAgICBjdXJyZW50Um93ID0gYmxhbmtBZnRlclN1YnRvdGFsLm51bWJlciArIDE7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU0XDh8ODTyAzOiBUT1RBSVMgUE9SIERBVEEgKFNFIERJU1BPTsONVkVMKVxyXG4gICAgaWYgKHN1bW1hcnlEYXRhLmRhdGVTcGVjaWZpY1RvdGFscyAmJiBzdW1tYXJ5RGF0YS5kYXRlU3BlY2lmaWNUb3RhbHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnW0VYUE9SVF0gQWRpY2lvbmFuZG8gc2XDp8OjbyBUT1RBTCBQT1IgRElBIERBIFNFTUFOQScpO1xyXG4gICAgICAvLyBDcmlhIGRpcmV0YW1lbnRlIGEgbGluaGEgZGUgY2FiZcOnYWxobyAoc2VtIGRlc2xvY2FtZW50byBpbmNvcnJldG8pXHJcbiAgICAgIGNvbnN0IGhlYWRlclJvdyA9IHNoZWV0LmFkZFJvdyhbJ1RPVEFMIFBPUiBESUEgREEgU0VNQU5BJywgJ1RvdGFsJ10pO1xyXG4gICAgICBoZWFkZXJSb3cuZWFjaENlbGwoKGNlbGwsIGNvbE51bWJlcikgPT4ge1xyXG4gICAgICAgIGlmIChjb2xOdW1iZXIgPD0gMikgY2VsbC5zdHlsZSA9IGhlYWRlclN0eWxlO1xyXG4gICAgICB9KTtcclxuICAgICAgaGVhZGVyUm93LmhlaWdodCA9IDI1O1xyXG4gICAgICBjdXJyZW50Um93ID0gaGVhZGVyUm93Lm51bWJlciArIDE7XHJcblxyXG4gICAgICAvLyBPcmRlbmFyIGRhdGFzIGNyb25vbG9naWNhbWVudGVcclxuICAgICAgY29uc3Qgc29ydGVkRGF0ZVRvdGFscyA9IFsuLi5zdW1tYXJ5RGF0YS5kYXRlU3BlY2lmaWNUb3RhbHNdLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgICBjb25zdCBwYXJzZURhdGUgPSAoZGF0ZVN0cjogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBwYXJ0cyA9IGRhdGVTdHIuc3BsaXQoJy8nKTtcclxuICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShwYXJzZUludChwYXJ0c1syXSksIHBhcnNlSW50KHBhcnRzWzFdKSAtIDEsIHBhcnNlSW50KHBhcnRzWzBdKSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gcGFyc2VEYXRlKGEuZGF5KS5nZXRUaW1lKCkgLSBwYXJzZURhdGUoYi5kYXkpLmdldFRpbWUoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBsZXQgY29uc29saWRhdGVkR3JhbmRUb3RhbCA9IDA7XHJcblxyXG4gICAgICAvLyBBZGljaW9uYXIgZGFkb3MgZGFzIGRhdGFzIGNvbSBkaWEgZGEgc2VtYW5hXHJcbiAgICAgIGZvciAoY29uc3QgZGF0ZURhdGEgb2Ygc29ydGVkRGF0ZVRvdGFscykge1xyXG4gICAgICAgIGNvbnN0IHBhcnRzID0gZGF0ZURhdGEuZGF5LnNwbGl0KCcvJyk7XHJcbiAgICAgICAgbGV0IGRheU9mV2VlayA9ICcnO1xyXG4gICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDMpIHtcclxuICAgICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShwYXJzZUludChwYXJ0c1syXSksIHBhcnNlSW50KHBhcnRzWzFdKSAtIDEsIHBhcnNlSW50KHBhcnRzWzBdKSk7XHJcbiAgICAgICAgICBjb25zdCBkYXlOYW1lcyA9IFsnRG9taW5nbycsICdTZWd1bmRhJywgJ1RlcsOnYScsICdRdWFydGEnLCAnUXVpbnRhJywgJ1NleHRhJywgJ1PDoWJhZG8nXTtcclxuICAgICAgICAgIGRheU9mV2VlayA9IGRheU5hbWVzW2RhdGUuZ2V0RGF5KCldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBkYXRlV2l0aERheSA9IGRheU9mV2VlayA/IGAke2RhdGVEYXRhLmRheX0gKCR7ZGF5T2ZXZWVrfSlgIDogZGF0ZURhdGEuZGF5O1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGRhdGFSb3cgPSBzaGVldC5hZGRSb3coW2RhdGVXaXRoRGF5LCBkYXRlRGF0YS50b3RhbF0pO1xyXG4gICAgICAgIGRhdGFSb3cuZWFjaENlbGwoKGNlbGwsIGNvbE51bWJlcikgPT4ge1xyXG4gICAgICAgICAgaWYgKGNvbE51bWJlciA8PSAyKSB7XHJcbiAgICAgICAgICAgIGNlbGwuc3R5bGUgPSBjZWxsU3R5bGU7XHJcbiAgICAgICAgICAgIGlmIChjb2xOdW1iZXIgPT09IDIpIGNlbGwubnVtRm10ID0gJ1IkICMsIyMwLjAwJztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zb2xpZGF0ZWRHcmFuZFRvdGFsICs9IGRhdGVEYXRhLnRvdGFsO1xyXG4gICAgICAgIGN1cnJlbnRSb3cgPSBkYXRhUm93Lm51bWJlciArIDE7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFRPVEFMIEdFUkFMIEZJTkFMXHJcbiAgICAgIGNvbnN0IGNvbnNvbGlkYXRlZFRvdGFsUm93ID0gc2hlZXQuYWRkUm93KFsnVE9UQUwgR0VSQUwgKERhdGFzKScsIGNvbnNvbGlkYXRlZEdyYW5kVG90YWxdKTtcclxuICAgICAgY29uc29saWRhdGVkVG90YWxSb3cuZWFjaENlbGwoKGNlbGwsIGNvbE51bWJlcikgPT4ge1xyXG4gICAgICAgIGlmIChjb2xOdW1iZXIgPD0gMikge1xyXG4gICAgICAgICAgY2VsbC5zdHlsZSA9IHtcclxuICAgICAgICAgICAgZm9udDogeyBib2xkOiB0cnVlLCBjb2xvcjogeyBhcmdiOiAnRkZGRkZGJyB9IH0sXHJcbiAgICAgICAgICAgIGZpbGw6IHsgdHlwZTogJ3BhdHRlcm4nIGFzIGNvbnN0LCBwYXR0ZXJuOiAnc29saWQnIGFzIGNvbnN0LCBmZ0NvbG9yOiB7IGFyZ2I6ICcyRjU1OTcnIH0gfSxcclxuICAgICAgICAgICAgYm9yZGVyOiB7XHJcbiAgICAgICAgICAgICAgdG9wOiB7IHN0eWxlOiAndGhpbicgYXMgY29uc3QgfSwgbGVmdDogeyBzdHlsZTogJ3RoaW4nIGFzIGNvbnN0IH0sXHJcbiAgICAgICAgICAgICAgYm90dG9tOiB7IHN0eWxlOiAndGhpbicgYXMgY29uc3QgfSwgcmlnaHQ6IHsgc3R5bGU6ICd0aGluJyBhcyBjb25zdCB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGFsaWdubWVudDogeyBob3Jpem9udGFsOiAnY2VudGVyJyBhcyBjb25zdCwgdmVydGljYWw6ICdtaWRkbGUnIGFzIGNvbnN0IH1cclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICBpZiAoY29sTnVtYmVyID09PSAyKSBjZWxsLm51bUZtdCA9ICdSJCAjLCMjMC4wMCc7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDT05GSUdVUkHDh8ODTyBERSBMQVJHVVJBUyBEQVMgQ09MVU5BU1xyXG4gICAgc2hlZXQuZ2V0Q29sdW1uKDEpLndpZHRoID0gMzU7IC8vIEZpbGlhbFxyXG4gICAgc2hlZXQuZ2V0Q29sdW1uKDIpLndpZHRoID0gMjI7IC8vIFRvdGFsIEEgUGFnYXJcclxuXHJcbiAgICAvLyBIRUFERVJTIERFIFJFU1BPU1RBIFBBUkEgRE9XTkxPQURcclxuICAgIHJlcy5zZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQuc3ByZWFkc2hlZXRtbC5zaGVldCcpO1xyXG4gICAgcmVzLnNldEhlYWRlcignQ29udGVudC1EaXNwb3NpdGlvbicsIGBhdHRhY2htZW50OyBmaWxlbmFtZT1cInJlc3Vtb190b3RhbF9maWxpYWlzXyR7bmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF19Lnhsc3hcImApO1xyXG5cclxuICAgIC8vIEVTQ1JJVEEgRSBFTlZJTyBETyBBUlFVSVZPXHJcbiAgICBhd2FpdCB3b3JrYm9vay54bHN4LndyaXRlKHJlcyk7XHJcbiAgICByZXMuZW5kKCk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvIG5hIGV4cG9ydGHDp8OjbyBkbyByZXN1bW8gRXhjZWw6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm8gaW50ZXJubyBkbyBzZXJ2aWRvcicgfSk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbIkV4Y2VsSlMiLCJzdG9yYWdlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJrZXlzIiwiZ2V0Iiwic3VtbWFyeURhdGEiLCJkZWJ1ZyIsInN0b3JhZ2VLZXlzIiwiaGFzRGF0YSIsImJyYW5jaGVzIiwibGVuZ3RoIiwiZGF0ZVNwZWNpZmljVG90YWxzIiwiZ3JhbmRUb3RhbCIsIndvcmtib29rIiwiV29ya2Jvb2siLCJzaGVldCIsImFkZFdvcmtzaGVldCIsImhlYWRlclN0eWxlIiwiZm9udCIsImJvbGQiLCJjb2xvciIsImFyZ2IiLCJmaWxsIiwidHlwZSIsInBhdHRlcm4iLCJmZ0NvbG9yIiwiYWxpZ25tZW50IiwiaG9yaXpvbnRhbCIsInZlcnRpY2FsIiwiYm9yZGVyIiwidG9wIiwic3R5bGUiLCJsZWZ0IiwiYm90dG9tIiwicmlnaHQiLCJjZWxsU3R5bGUiLCJ0aXRsZVN0eWxlIiwic2l6ZSIsImN1cnJlbnRSb3ciLCJhZGRSb3ciLCJtZXJnZUNlbGxzIiwiZ2V0Q2VsbCIsImdldFJvdyIsImhlaWdodCIsImVhY2hDZWxsIiwiY2VsbCIsImNvbE51bWJlciIsImJyYW5jaCIsIm5hbWUiLCJ0b3RhbEFQYWdhciIsInJvdyIsIm51bUZtdCIsInN1YnRvdGFsUm93IiwiZ3JhbmRUb3RhbEFQYWdhciIsIm51bWJlciIsImJsYW5rQWZ0ZXJTdWJ0b3RhbCIsImhlYWRlclJvdyIsInNvcnRlZERhdGVUb3RhbHMiLCJzb3J0IiwiYSIsImIiLCJwYXJzZURhdGUiLCJkYXRlU3RyIiwicGFydHMiLCJzcGxpdCIsIkRhdGUiLCJwYXJzZUludCIsImRheSIsImdldFRpbWUiLCJjb25zb2xpZGF0ZWRHcmFuZFRvdGFsIiwiZGF0ZURhdGEiLCJkYXlPZldlZWsiLCJkYXRlIiwiZGF5TmFtZXMiLCJnZXREYXkiLCJkYXRlV2l0aERheSIsImRhdGFSb3ciLCJ0b3RhbCIsImNvbnNvbGlkYXRlZFRvdGFsUm93IiwiZ2V0Q29sdW1uIiwid2lkdGgiLCJzZXRIZWFkZXIiLCJ0b0lTT1N0cmluZyIsInhsc3giLCJ3cml0ZSIsImVuZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/export-summary-excel.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fexport-summary-excel&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cexport-summary-excel.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();