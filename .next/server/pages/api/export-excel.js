"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/export-excel";
exports.ids = ["pages/api/export-excel"];
exports.modules = {

/***/ "exceljs":
/*!**************************!*\
  !*** external "exceljs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("exceljs");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fexport-excel&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cexport-excel.ts&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fexport-excel&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cexport-excel.ts&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_export_excel_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\export-excel.ts */ \"(api)/./pages/api/export-excel.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_export_excel_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_export_excel_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/export-excel\",\n        pathname: \"/api/export-excel\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_export_excel_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmV4cG9ydC1leGNlbCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDZXhwb3J0LWV4Y2VsLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzBEO0FBQzFEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx1REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsdURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbm90YWZsZXgtbmV4dGpzLz9kNGZjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcZXhwb3J0LWV4Y2VsLnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZXhwb3J0LWV4Y2VsXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZXhwb3J0LWV4Y2VsXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fexport-excel&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cexport-excel.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/export-excel.ts":
/*!***********************************!*\
  !*** ./pages/api/export-excel.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var exceljs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! exceljs */ \"exceljs\");\n/* harmony import */ var exceljs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(exceljs__WEBPACK_IMPORTED_MODULE_0__);\n\n// Estilos Excel obrigatórios\nconst headerStyle = {\n    font: {\n        bold: true,\n        color: {\n            argb: \"FFFFFF\"\n        }\n    },\n    fill: {\n        type: \"pattern\",\n        pattern: \"solid\",\n        fgColor: {\n            argb: \"2F5597\"\n        }\n    },\n    alignment: {\n        horizontal: \"center\",\n        vertical: \"middle\"\n    },\n    border: {\n        top: {\n            style: \"thin\"\n        },\n        left: {\n            style: \"thin\"\n        },\n        bottom: {\n            style: \"thin\"\n        },\n        right: {\n            style: \"thin\"\n        }\n    }\n};\nconst cellStyle = {\n    border: {\n        top: {\n            style: \"thin\"\n        },\n        left: {\n            style: \"thin\"\n        },\n        bottom: {\n            style: \"thin\"\n        },\n        right: {\n            style: \"thin\"\n        }\n    }\n};\nconst titleStyle = {\n    font: {\n        bold: true,\n        size: 16,\n        color: {\n            argb: \"FFFFFF\"\n        }\n    },\n    alignment: {\n        horizontal: \"center\",\n        vertical: \"middle\"\n    },\n    fill: {\n        type: \"pattern\",\n        pattern: \"solid\",\n        fgColor: {\n            argb: \"2F5597\"\n        }\n    }\n};\nconst subHeaderStyle = {\n    font: {\n        bold: true,\n        size: 14,\n        color: {\n            argb: \"FFFFFF\"\n        }\n    },\n    fill: {\n        type: \"pattern\",\n        pattern: \"solid\",\n        fgColor: {\n            argb: \"1F4E79\"\n        }\n    },\n    alignment: {\n        horizontal: \"center\",\n        vertical: \"middle\"\n    }\n};\nconst totalRowStyle = {\n    font: {\n        bold: true,\n        color: {\n            argb: \"FFFFFF\"\n        }\n    },\n    fill: {\n        type: \"pattern\",\n        pattern: \"solid\",\n        fgColor: {\n            argb: \"366092\"\n        }\n    },\n    alignment: {\n        horizontal: \"center\",\n        vertical: \"middle\"\n    }\n};\nasync function handler(req, res) {\n    console.log(\"Iniciando gera\\xe7\\xe3o do Excel...\");\n    console.log(\"Method:\", req.method);\n    try {\n        // Extrair informações do relatório\n        const { name: reportName, startDate, endDate, categories } = req.body || {};\n        let summaryData = null;\n        let allInvoices = [];\n        let allBranchSummaries = [];\n        // Verificar se existe dados de resumo em sessão/cache ou usar dados hardcoded\n        if (req.method === \"POST\" && req.body) {\n            console.log(\"Dados recebidos no body:\", req.body);\n            if (req.body.summaryData) {\n                summaryData = req.body.summaryData;\n            }\n            if (req.body.allInvoices) {\n                allInvoices = req.body.allInvoices;\n            }\n            if (req.body.allBranchSummaries) {\n                allBranchSummaries = req.body.allBranchSummaries;\n            }\n        }\n        // Se não temos dados, usar dados hardcoded para demonstração\n        if (!summaryData || summaryData.branches.length === 0) {\n            console.log(\"Usando dados hardcoded para demonstra\\xe7\\xe3o\");\n            summaryData = {\n                branches: [\n                    {\n                        name: \"GO SEEDS\",\n                        totalAPagar: 1912040.00,\n                        totalAReceber: 3175990.36,\n                        total: 5087030.36\n                    },\n                    {\n                        name: \"BEIJA FLOR\",\n                        totalAPagar: 129763.24,\n                        totalAReceber: 0.00,\n                        total: 129763.24\n                    },\n                    {\n                        name: \"SAGUIA\",\n                        totalAPagar: 138251.10,\n                        totalAReceber: 0.00,\n                        total: 138251.10\n                    },\n                    {\n                        name: \"ULTRA SEEDS\",\n                        totalAPagar: 80.96,\n                        totalAReceber: 0.00,\n                        total: 80.96\n                    }\n                ],\n                dateSpecificTotals: [\n                    {\n                        day: \"15/09/2024\",\n                        total: 500000.00\n                    },\n                    {\n                        day: \"16/09/2024\",\n                        total: 750000.00\n                    },\n                    {\n                        day: \"17/09/2024\",\n                        total: 950000.00\n                    }\n                ],\n                grandTotal: 5355135.66,\n                grandTotalAPagar: 2180135.30,\n                grandTotalAReceber: 3175000.36\n            };\n            // Gerar dados de invoices simulados baseados no summaryData\n            allInvoices = generateSimulatedInvoices(summaryData);\n            allBranchSummaries = summaryData.branches.map((branch)=>({\n                    branch: branch.name,\n                    invoiceCount: Math.floor(Math.random() * 10) + 5,\n                    totalValue: branch.total.toLocaleString(\"pt-BR\", {\n                        style: \"currency\",\n                        currency: \"BRL\"\n                    })\n                }));\n        }\n        // Calcular período real baseado nas datas dos documentos\n        let actualStartDate;\n        let actualEndDate;\n        if (allInvoices.length > 0) {\n            const invoiceDates = allInvoices.map((inv)=>new Date(inv.date)).sort((a, b)=>a.getTime() - b.getTime());\n            actualStartDate = invoiceDates[0];\n            actualEndDate = invoiceDates[invoiceDates.length - 1];\n        } else {\n            actualStartDate = new Date();\n            actualEndDate = new Date();\n        }\n        // Criar workbook\n        const workbook = new (exceljs__WEBPACK_IMPORTED_MODULE_0___default().Workbook)();\n        console.log(\"Criando aba de Resumo Geral...\");\n        await createAdvancedSummaryWorksheet(workbook, summaryData, allInvoices, reportName || \"Relat\\xf3rio de Notas Fiscais\", actualStartDate, actualEndDate);\n        console.log(\"Criando abas individuais por filial...\");\n        for (const branch of summaryData.branches){\n            const branchInvoices = allInvoices.filter((inv)=>inv.branch === branch.name);\n            await createAdvancedBranchWorksheet(workbook, branch, branchInvoices);\n        }\n        // Configurar resposta HTTP\n        const fileName = `relatorio_detalhado_${new Date().toISOString().split(\"T\")[0]}.xlsx`;\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\n        res.setHeader(\"Content-Disposition\", `attachment; filename=\"${fileName}\"`);\n        // Escrever workbook na resposta\n        await workbook.xlsx.write(res);\n        console.log(\"Excel gerado com sucesso!\");\n        res.end();\n    } catch (error) {\n        console.error(\"Erro na gera\\xe7\\xe3o do Excel:\", error);\n        if (!res.headersSent) {\n            res.status(500).json({\n                success: false,\n                message: \"Erro interno do servidor: \" + (error instanceof Error ? error.message : \"Erro desconhecido\")\n            });\n        }\n    }\n}\n// Função para gerar dados de invoices simulados\nfunction generateSimulatedInvoices(summaryData) {\n    const invoices = [];\n    let idCounter = 1;\n    summaryData.branches.forEach((branch)=>{\n        // Gerar algumas invoices A_PAGAR\n        if (branch.totalAPagar > 0) {\n            const numInvoicesAPagar = Math.floor(Math.random() * 5) + 2;\n            const averageValue = branch.totalAPagar / numInvoicesAPagar;\n            for(let i = 0; i < numInvoicesAPagar; i++){\n                const value = averageValue * (0.8 + Math.random() * 0.4); // Variação de ±20%\n                const date = new Date();\n                date.setDate(date.getDate() + Math.floor(Math.random() * 30)); // Próximos 30 dias\n                invoices.push({\n                    id: `inv_${idCounter++}`,\n                    branch: branch.name,\n                    invoiceNumber: `NF-${String(i + 1).padStart(3, \"0\")}`,\n                    date: date,\n                    value: value.toLocaleString(\"pt-BR\", {\n                        style: \"currency\",\n                        currency: \"BRL\"\n                    }),\n                    supplier: `FORNECEDOR ${String.fromCharCode(65 + i)}`,\n                    documentType: \"A_PAGAR\",\n                    sourceFile: `${branch.name}.csv`,\n                    valueNumeric: value\n                });\n            }\n        }\n        // Gerar algumas invoices A_RECEBER\n        if (branch.totalAReceber > 0) {\n            const numInvoicesAReceber = Math.floor(Math.random() * 3) + 1;\n            const averageValue = branch.totalAReceber / numInvoicesAReceber;\n            for(let i = 0; i < numInvoicesAReceber; i++){\n                const value = averageValue * (0.8 + Math.random() * 0.4);\n                const date = new Date();\n                date.setDate(date.getDate() + Math.floor(Math.random() * 30));\n                invoices.push({\n                    id: `inv_${idCounter++}`,\n                    branch: branch.name,\n                    invoiceNumber: `REC-${String(i + 1).padStart(3, \"0\")}`,\n                    date: date,\n                    value: value.toLocaleString(\"pt-BR\", {\n                        style: \"currency\",\n                        currency: \"BRL\"\n                    }),\n                    supplier: `CLIENTE ${String.fromCharCode(65 + i)}`,\n                    documentType: \"A_RECEBER\",\n                    sourceFile: `${branch.name}.csv`,\n                    valueNumeric: value\n                });\n            }\n        }\n    });\n    return invoices;\n}\n// Função para criar a aba de resumo geral avançada\nasync function createAdvancedSummaryWorksheet(workbook, summaryData, allInvoices, reportName, actualStartDate, actualEndDate) {\n    const summarySheet = workbook.addWorksheet(\"Resumo Geral\");\n    let summaryCurrentRow = 1;\n    // Header do relatório\n    summarySheet.addRow([\n        reportName\n    ]);\n    summarySheet.mergeCells(`A${summaryCurrentRow}:D${summaryCurrentRow}`);\n    summarySheet.getCell(`A${summaryCurrentRow}`).style = titleStyle;\n    summarySheet.getRow(summaryCurrentRow).height = 35;\n    summaryCurrentRow++;\n    // Período\n    const periodText = `PERÍODO: ${actualStartDate.toLocaleDateString(\"pt-BR\")} - ${actualEndDate.toLocaleDateString(\"pt-BR\")}`;\n    summarySheet.addRow([\n        periodText\n    ]);\n    summarySheet.mergeCells(`A${summaryCurrentRow}:D${summaryCurrentRow}`);\n    summarySheet.getCell(`A${summaryCurrentRow}`).style = {\n        font: {\n            bold: true,\n            size: 12\n        },\n        fill: {\n            type: \"pattern\",\n            pattern: \"solid\",\n            fgColor: {\n                argb: \"E7E6E6\"\n            }\n        },\n        alignment: {\n            horizontal: \"center\",\n            vertical: \"middle\"\n        }\n    };\n    summaryCurrentRow++;\n    // Linha vazia\n    summarySheet.addRow([]);\n    summaryCurrentRow++;\n    // Headers das colunas\n    summarySheet.addRow([\n        \"Vencimento\",\n        \"Transacionador\",\n        \"Documento\",\n        \"Valor\"\n    ]);\n    summarySheet.getRow(summaryCurrentRow).eachCell((cell)=>{\n        cell.style = headerStyle;\n    });\n    summaryCurrentRow++;\n    // Agrupar invoices por arquivo fonte e tipo de documento\n    const invoicesByFileAndType = new Map();\n    for (const invoice of allInvoices){\n        const sourceFile = invoice.sourceFile || \"Unknown\";\n        if (!invoicesByFileAndType.has(sourceFile)) {\n            invoicesByFileAndType.set(sourceFile, {\n                A_PAGAR: [],\n                A_RECEBER: []\n            });\n        }\n        const fileTypes = invoicesByFileAndType.get(sourceFile);\n        const docType = invoice.documentType || \"A_PAGAR\";\n        fileTypes[docType].push(invoice);\n    }\n    // Processar cada arquivo e tipo de documento\n    for (const [fileName, fileTypes] of Array.from(invoicesByFileAndType)){\n        for (const [docType, fileInvoices] of Object.entries(fileTypes)){\n            if (fileInvoices.length === 0) continue;\n            const typeLabel = docType === \"A_PAGAR\" ? \"CONTAS A PAGAR\" : \"CONTAS A RECEBER\";\n            const cleanFileName = fileName.replace(/\\.(csv|CSV)$/, \"\");\n            // Header da categoria\n            summarySheet.addRow([\n                `${typeLabel} - ${cleanFileName}`,\n                \"\",\n                \"\",\n                \"\"\n            ]);\n            summarySheet.mergeCells(`A${summaryCurrentRow}:D${summaryCurrentRow}`);\n            summarySheet.getCell(`A${summaryCurrentRow}`).style = subHeaderStyle;\n            summaryCurrentRow++;\n            // Ordenar por data\n            fileInvoices.sort((a, b)=>new Date(a.date).getTime() - new Date(b.date).getTime());\n            // Adicionar transações com totais diários\n            let currentDate = \"\";\n            let dailyTotal = 0;\n            for (const invoice of fileInvoices){\n                const invoiceDate = new Date(invoice.date).toLocaleDateString(\"pt-BR\");\n                const invoiceValue = invoice.valueNumeric;\n                // Verificar mudança de data para total diário\n                if (currentDate && currentDate !== invoiceDate && dailyTotal > 0) {\n                    summarySheet.addRow([\n                        \"\",\n                        \"\",\n                        \"TOTAL DI\\xc1RIO\",\n                        dailyTotal\n                    ]);\n                    const totalRow = summarySheet.getRow(summaryCurrentRow);\n                    totalRow.eachCell((cell, colNumber)=>{\n                        cell.style = {\n                            font: {\n                                bold: true\n                            },\n                            fill: {\n                                type: \"pattern\",\n                                pattern: \"solid\",\n                                fgColor: {\n                                    argb: \"F2F2F2\"\n                                }\n                            },\n                            numFmt: colNumber === 4 ? \"R$ #,##0.00\" : undefined,\n                            border: cellStyle.border\n                        };\n                    });\n                    summaryCurrentRow++;\n                    dailyTotal = 0;\n                }\n                // Adicionar linha da transação\n                summarySheet.addRow([\n                    invoiceDate,\n                    invoice.supplier || \"FORNECEDOR N\\xc3O IDENTIFICADO\",\n                    invoice.invoiceNumber,\n                    invoiceValue\n                ]);\n                const row = summarySheet.getRow(summaryCurrentRow);\n                row.eachCell((cell, colNumber)=>{\n                    cell.style = cellStyle;\n                    if (colNumber === 4) {\n                        cell.numFmt = \"R$ #,##0.00\";\n                    }\n                });\n                currentDate = invoiceDate;\n                dailyTotal += invoiceValue;\n                summaryCurrentRow++;\n            }\n            // Total final da categoria se houver dados pendentes\n            if (dailyTotal > 0) {\n                summarySheet.addRow([\n                    \"\",\n                    \"\",\n                    \"TOTAL DI\\xc1RIO\",\n                    dailyTotal\n                ]);\n                const totalRow = summarySheet.getRow(summaryCurrentRow);\n                totalRow.eachCell((cell, colNumber)=>{\n                    cell.style = {\n                        font: {\n                            bold: true\n                        },\n                        fill: {\n                            type: \"pattern\",\n                            pattern: \"solid\",\n                            fgColor: {\n                                argb: \"F2F2F2\"\n                            }\n                        },\n                        numFmt: colNumber === 4 ? \"R$ #,##0.00\" : undefined,\n                        border: cellStyle.border\n                    };\n                });\n                summaryCurrentRow++;\n            }\n            // Total da categoria\n            const categoryTotal = fileInvoices.reduce((sum, inv)=>sum + inv.valueNumeric, 0);\n            summarySheet.addRow([\n                \"\",\n                \"\",\n                `TOTAL ${typeLabel}`,\n                categoryTotal\n            ]);\n            const categoryTotalRow = summarySheet.getRow(summaryCurrentRow);\n            categoryTotalRow.eachCell((cell, colNumber)=>{\n                cell.style = {\n                    ...totalRowStyle,\n                    numFmt: colNumber === 4 ? \"R$ #,##0.00\" : undefined,\n                    border: cellStyle.border\n                };\n            });\n            summaryCurrentRow++;\n            // Linha vazia para separação\n            summarySheet.addRow([]);\n            summaryCurrentRow++;\n        }\n    }\n    // Total geral final\n    summarySheet.addRow([\n        \"\",\n        \"\",\n        \"TOTAL GERAL\",\n        summaryData.grandTotal\n    ]);\n    const grandTotalRow = summarySheet.getRow(summaryCurrentRow);\n    grandTotalRow.eachCell((cell, colNumber)=>{\n        cell.style = {\n            ...totalRowStyle,\n            numFmt: colNumber === 4 ? \"R$ #,##0.00\" : undefined,\n            border: cellStyle.border,\n            font: {\n                bold: true,\n                size: 14,\n                color: {\n                    argb: \"FFFFFF\"\n                }\n            }\n        };\n    });\n    // Definir larguras das colunas\n    summarySheet.getColumn(1).width = 15; // Data\n    summarySheet.getColumn(2).width = 60; // Transacionador  \n    summarySheet.getColumn(3).width = 20; // Documento\n    summarySheet.getColumn(4).width = 18; // Valor\n}\n// Função para criar aba individual da filial avançada\nasync function createAdvancedBranchWorksheet(workbook, branch, branchInvoices) {\n    let cleanBranchName = branch.name.replace(/[\\/\\\\\\?\\*\\[\\]]/g, \"_\").substring(0, 25);\n    const worksheet = workbook.addWorksheet(cleanBranchName);\n    let currentRow = 1;\n    // Título da filial\n    const titleRow = worksheet.addRow([\n        `DETALHAMENTO - ${branch.name}`\n    ]);\n    worksheet.mergeCells(`A${currentRow}:E${currentRow}`);\n    titleRow.getCell(1).style = titleStyle;\n    titleRow.height = 30;\n    currentRow++;\n    // Período\n    if (branchInvoices.length > 0) {\n        const branchDates = branchInvoices.map((inv)=>new Date(inv.date)).sort((a, b)=>a.getTime() - b.getTime());\n        const startDate = branchDates[0];\n        const endDate = branchDates[branchDates.length - 1];\n        const periodText = `PERÍODO: ${startDate.toLocaleDateString(\"pt-BR\")} - ${endDate.toLocaleDateString(\"pt-BR\")}`;\n        worksheet.addRow([\n            periodText\n        ]);\n        worksheet.mergeCells(`A${currentRow}:E${currentRow}`);\n        worksheet.getCell(`A${currentRow}`).style = {\n            font: {\n                bold: true,\n                size: 12\n            },\n            fill: {\n                type: \"pattern\",\n                pattern: \"solid\",\n                fgColor: {\n                    argb: \"E7E6E6\"\n                }\n            },\n            alignment: {\n                horizontal: \"center\",\n                vertical: \"middle\"\n            }\n        };\n        currentRow++;\n    }\n    // Linha vazia\n    worksheet.addRow([]);\n    currentRow++;\n    // Resumo da filial\n    const resumoRow = worksheet.addRow([\n        \"RESUMO DA FILIAL\"\n    ]);\n    worksheet.mergeCells(`A${currentRow}:E${currentRow}`);\n    resumoRow.getCell(1).style = subHeaderStyle;\n    resumoRow.height = 25;\n    currentRow++;\n    worksheet.addRow([\n        \"Total A Pagar:\",\n        `R$ ${branch.totalAPagar.toLocaleString(\"pt-BR\", {\n            minimumFractionDigits: 2\n        })}`\n    ]);\n    currentRow++;\n    worksheet.addRow([\n        \"Total A Receber:\",\n        `R$ ${branch.totalAReceber.toLocaleString(\"pt-BR\", {\n            minimumFractionDigits: 2\n        })}`\n    ]);\n    currentRow++;\n    const saldoLiquido = branch.totalAReceber - branch.totalAPagar;\n    const saldoRow = worksheet.addRow([\n        \"Saldo L\\xedquido:\",\n        `R$ ${saldoLiquido.toLocaleString(\"pt-BR\", {\n            minimumFractionDigits: 2\n        })}`\n    ]);\n    // Colorir saldo líquido\n    const saldoCell = saldoRow.getCell(2);\n    saldoCell.font = {\n        bold: true,\n        color: {\n            argb: saldoLiquido > 0 ? \"008000\" : \"FF0000\"\n        }\n    };\n    currentRow++;\n    // Linha vazia\n    worksheet.addRow([]);\n    currentRow++;\n    worksheet.addRow([]);\n    currentRow++;\n    // Detalhamento de transações por tipo\n    if (branchInvoices.length > 0) {\n        // Separar por tipo de documento\n        const apagarInvoices = branchInvoices.filter((inv)=>inv.documentType === \"A_PAGAR\");\n        const areceberInvoices = branchInvoices.filter((inv)=>inv.documentType === \"A_RECEBER\");\n        // Processar A_PAGAR\n        if (apagarInvoices.length > 0) {\n            const aPagarHeaderRow = worksheet.addRow([\n                \"CONTAS A PAGAR\"\n            ]);\n            worksheet.mergeCells(`A${currentRow}:E${currentRow}`);\n            aPagarHeaderRow.getCell(1).style = subHeaderStyle;\n            currentRow++;\n            worksheet.addRow([]);\n            currentRow++;\n            // Cabeçalhos das transações A_PAGAR\n            const transHeaderRow = worksheet.addRow([\n                \"Vencimento\",\n                \"Transacionador\",\n                \"Documento\",\n                \"Valor\",\n                \"Status\"\n            ]);\n            transHeaderRow.eachCell((cell)=>{\n                cell.style = headerStyle;\n            });\n            currentRow++;\n            // Ordenar por data e adicionar transações\n            apagarInvoices.sort((a, b)=>new Date(a.date).getTime() - new Date(b.date).getTime());\n            let currentDate = \"\";\n            let dailyTotal = 0;\n            apagarInvoices.forEach((invoice)=>{\n                const invoiceDate = new Date(invoice.date).toLocaleDateString(\"pt-BR\");\n                // Verificar mudança de data para total diário\n                if (currentDate && currentDate !== invoiceDate && dailyTotal > 0) {\n                    worksheet.addRow([\n                        \"\",\n                        \"\",\n                        \"TOTAL DI\\xc1RIO\",\n                        dailyTotal,\n                        \"\"\n                    ]);\n                    const totalRow = worksheet.getRow(currentRow);\n                    totalRow.eachCell((cell, colNumber)=>{\n                        cell.style = {\n                            font: {\n                                bold: true\n                            },\n                            fill: {\n                                type: \"pattern\",\n                                pattern: \"solid\",\n                                fgColor: {\n                                    argb: \"F2F2F2\"\n                                }\n                            },\n                            numFmt: colNumber === 4 ? \"R$ #,##0.00\" : undefined,\n                            border: cellStyle.border\n                        };\n                    });\n                    currentRow++;\n                    dailyTotal = 0;\n                }\n                worksheet.addRow([\n                    invoiceDate,\n                    invoice.supplier,\n                    invoice.invoiceNumber,\n                    invoice.valueNumeric,\n                    \"Pendente\"\n                ]);\n                const row = worksheet.getRow(currentRow);\n                row.eachCell((cell, colNumber)=>{\n                    cell.style = cellStyle;\n                    if (colNumber === 4) {\n                        cell.numFmt = \"R$ #,##0.00\";\n                    }\n                });\n                currentDate = invoiceDate;\n                dailyTotal += invoice.valueNumeric;\n                currentRow++;\n            });\n            // Total final A_PAGAR\n            if (dailyTotal > 0) {\n                worksheet.addRow([\n                    \"\",\n                    \"\",\n                    \"TOTAL DI\\xc1RIO\",\n                    dailyTotal,\n                    \"\"\n                ]);\n                const totalRow = worksheet.getRow(currentRow);\n                totalRow.eachCell((cell, colNumber)=>{\n                    cell.style = {\n                        font: {\n                            bold: true\n                        },\n                        fill: {\n                            type: \"pattern\",\n                            pattern: \"solid\",\n                            fgColor: {\n                                argb: \"F2F2F2\"\n                            }\n                        },\n                        numFmt: colNumber === 4 ? \"R$ #,##0.00\" : undefined,\n                        border: cellStyle.border\n                    };\n                });\n                currentRow++;\n            }\n            const totalAPagarRow = worksheet.addRow([\n                \"\",\n                \"\",\n                \"TOTAL A PAGAR\",\n                branch.totalAPagar,\n                \"\"\n            ]);\n            totalAPagarRow.eachCell((cell, colNumber)=>{\n                cell.style = {\n                    ...totalRowStyle,\n                    numFmt: colNumber === 4 ? \"R$ #,##0.00\" : undefined,\n                    border: cellStyle.border\n                };\n            });\n            currentRow++;\n            // Linha vazia\n            worksheet.addRow([]);\n            currentRow++;\n        }\n        // Processar A_RECEBER\n        if (areceberInvoices.length > 0) {\n            const aReceberHeaderRow = worksheet.addRow([\n                \"CONTAS A RECEBER\"\n            ]);\n            worksheet.mergeCells(`A${currentRow}:E${currentRow}`);\n            aReceberHeaderRow.getCell(1).style = subHeaderStyle;\n            currentRow++;\n            worksheet.addRow([]);\n            currentRow++;\n            // Cabeçalhos das transações A_RECEBER\n            const transHeaderRow = worksheet.addRow([\n                \"Vencimento\",\n                \"Cliente\",\n                \"Documento\",\n                \"Valor\",\n                \"Status\"\n            ]);\n            transHeaderRow.eachCell((cell)=>{\n                cell.style = headerStyle;\n            });\n            currentRow++;\n            // Ordenar por data e adicionar transações\n            areceberInvoices.sort((a, b)=>new Date(a.date).getTime() - new Date(b.date).getTime());\n            let currentDate = \"\";\n            let dailyTotal = 0;\n            areceberInvoices.forEach((invoice)=>{\n                const invoiceDate = new Date(invoice.date).toLocaleDateString(\"pt-BR\");\n                // Verificar mudança de data para total diário\n                if (currentDate && currentDate !== invoiceDate && dailyTotal > 0) {\n                    worksheet.addRow([\n                        \"\",\n                        \"\",\n                        \"TOTAL DI\\xc1RIO\",\n                        dailyTotal,\n                        \"\"\n                    ]);\n                    const totalRow = worksheet.getRow(currentRow);\n                    totalRow.eachCell((cell, colNumber)=>{\n                        cell.style = {\n                            font: {\n                                bold: true\n                            },\n                            fill: {\n                                type: \"pattern\",\n                                pattern: \"solid\",\n                                fgColor: {\n                                    argb: \"F2F2F2\"\n                                }\n                            },\n                            numFmt: colNumber === 4 ? \"R$ #,##0.00\" : undefined,\n                            border: cellStyle.border\n                        };\n                    });\n                    currentRow++;\n                    dailyTotal = 0;\n                }\n                worksheet.addRow([\n                    invoiceDate,\n                    invoice.supplier,\n                    invoice.invoiceNumber,\n                    invoice.valueNumeric,\n                    \"Pendente\"\n                ]);\n                const row = worksheet.getRow(currentRow);\n                row.eachCell((cell, colNumber)=>{\n                    cell.style = cellStyle;\n                    if (colNumber === 4) {\n                        cell.numFmt = \"R$ #,##0.00\";\n                    }\n                });\n                currentDate = invoiceDate;\n                dailyTotal += invoice.valueNumeric;\n                currentRow++;\n            });\n            // Total final A_RECEBER\n            if (dailyTotal > 0) {\n                worksheet.addRow([\n                    \"\",\n                    \"\",\n                    \"TOTAL DI\\xc1RIO\",\n                    dailyTotal,\n                    \"\"\n                ]);\n                const totalRow = worksheet.getRow(currentRow);\n                totalRow.eachCell((cell, colNumber)=>{\n                    cell.style = {\n                        font: {\n                            bold: true\n                        },\n                        fill: {\n                            type: \"pattern\",\n                            pattern: \"solid\",\n                            fgColor: {\n                                argb: \"F2F2F2\"\n                            }\n                        },\n                        numFmt: colNumber === 4 ? \"R$ #,##0.00\" : undefined,\n                        border: cellStyle.border\n                    };\n                });\n                currentRow++;\n            }\n            const totalAReceberRow = worksheet.addRow([\n                \"\",\n                \"\",\n                \"TOTAL A RECEBER\",\n                branch.totalAReceber,\n                \"\"\n            ]);\n            totalAReceberRow.eachCell((cell, colNumber)=>{\n                cell.style = {\n                    ...totalRowStyle,\n                    numFmt: colNumber === 4 ? \"R$ #,##0.00\" : undefined,\n                    border: cellStyle.border\n                };\n            });\n            currentRow++;\n        }\n    } else {\n        // Mensagem quando não há transações detalhadas\n        const noDataRow = worksheet.addRow([\n            \"TRANSA\\xc7\\xd5ES DETALHADAS\"\n        ]);\n        worksheet.mergeCells(`A${currentRow}:E${currentRow}`);\n        noDataRow.getCell(1).style = subHeaderStyle;\n        currentRow++;\n        worksheet.addRow([]);\n        currentRow++;\n        worksheet.addRow([\n            \"Dados detalhados das transa\\xe7\\xf5es ser\\xe3o exibidos aqui quando dispon\\xedveis.\"\n        ]);\n        worksheet.addRow([\n            \"Para obter detalhes, fa\\xe7a upload dos arquivos CSV individuais.\"\n        ]);\n    }\n    // Ajustar largura das colunas\n    worksheet.columns = [\n        {\n            width: 15\n        },\n        {\n            width: 40\n        },\n        {\n            width: 20\n        },\n        {\n            width: 18\n        },\n        {\n            width: 12\n        } // Status\n    ];\n}\n// Função para criar a aba de resumo geral\nasync function createResumoGeralWorksheet(workbook, summaryData) {\n    const worksheet = workbook.addWorksheet(\"Resumo Geral\");\n    // Título principal\n    const titleRow = worksheet.addRow([\n        \"RESUMO GERAL - SALDO L\\xcdQUIDO POR FILIAL\"\n    ]);\n    worksheet.mergeCells(\"A1:D1\");\n    titleRow.getCell(1).fill = {\n        type: \"pattern\",\n        pattern: \"solid\",\n        fgColor: {\n            argb: \"FF4472C4\"\n        }\n    };\n    titleRow.getCell(1).font = {\n        bold: true,\n        color: {\n            argb: \"FFFFFFFF\"\n        },\n        size: 16\n    };\n    titleRow.getCell(1).alignment = {\n        horizontal: \"center\",\n        vertical: \"middle\"\n    };\n    titleRow.height = 30;\n    worksheet.addRow([]); // Linha vazia\n    // Cabeçalhos\n    const headerRow = worksheet.addRow([\n        \"FILIAL\",\n        \"TOTAL A PAGAR\",\n        \"TOTAL A RECEBER\",\n        \"SALDO L\\xcdQUIDO\"\n    ]);\n    headerRow.font = {\n        bold: true,\n        color: {\n            argb: \"FFFFFFFF\"\n        }\n    };\n    headerRow.fill = {\n        type: \"pattern\",\n        pattern: \"solid\",\n        fgColor: {\n            argb: \"FF4472C4\"\n        }\n    };\n    headerRow.alignment = {\n        horizontal: \"center\",\n        vertical: \"middle\"\n    };\n    // Dados das filiais\n    summaryData.branches.forEach((branch)=>{\n        const saldoLiquido = branch.totalAReceber - branch.totalAPagar;\n        const row = worksheet.addRow([\n            branch.name,\n            `R$ ${branch.totalAPagar.toLocaleString(\"pt-BR\", {\n                minimumFractionDigits: 2\n            })}`,\n            `R$ ${branch.totalAReceber.toLocaleString(\"pt-BR\", {\n                minimumFractionDigits: 2\n            })}`,\n            `R$ ${saldoLiquido.toLocaleString(\"pt-BR\", {\n                minimumFractionDigits: 2\n            })}`\n        ]);\n        // Colorir saldo líquido conforme valor\n        const saldoCell = row.getCell(4);\n        if (saldoLiquido > 0) {\n            saldoCell.font = {\n                color: {\n                    argb: \"FF008000\"\n                },\n                bold: true\n            }; // Verde\n        } else if (saldoLiquido < 0) {\n            saldoCell.font = {\n                color: {\n                    argb: \"FFFF0000\"\n                },\n                bold: true\n            }; // Vermelho\n        }\n    });\n    // Linha de total geral\n    worksheet.addRow([]); // Linha vazia\n    const totalRow = worksheet.addRow([\n        \"TOTAL GERAL\",\n        `R$ ${summaryData.grandTotalAPagar.toLocaleString(\"pt-BR\", {\n            minimumFractionDigits: 2\n        })}`,\n        `R$ ${summaryData.grandTotalAReceber.toLocaleString(\"pt-BR\", {\n            minimumFractionDigits: 2\n        })}`,\n        `R$ ${(summaryData.grandTotalAReceber - summaryData.grandTotalAPagar).toLocaleString(\"pt-BR\", {\n            minimumFractionDigits: 2\n        })}`\n    ]);\n    totalRow.font = {\n        bold: true,\n        size: 12\n    };\n    totalRow.fill = {\n        type: \"pattern\",\n        pattern: \"solid\",\n        fgColor: {\n            argb: \"FFE0E0E0\"\n        }\n    };\n    // Ajustar largura das colunas\n    worksheet.columns = [\n        {\n            width: 20\n        },\n        {\n            width: 18\n        },\n        {\n            width: 18\n        },\n        {\n            width: 18\n        } // Saldo Líquido\n    ];\n    // Adicionar bordas\n    const dataRange = worksheet.getRows(3, worksheet.rowCount - 2);\n    dataRange?.forEach((row)=>{\n        row.eachCell((cell)=>{\n            cell.border = {\n                top: {\n                    style: \"thin\"\n                },\n                left: {\n                    style: \"thin\"\n                },\n                bottom: {\n                    style: \"thin\"\n                },\n                right: {\n                    style: \"thin\"\n                }\n            };\n        });\n    });\n}\n// Função para criar aba individual da filial\nasync function createBranchWorksheet(workbook, branch, processedData) {\n    const worksheet = workbook.addWorksheet(branch.name);\n    // Título da filial\n    const titleRow = worksheet.addRow([\n        `DETALHAMENTO - ${branch.name}`\n    ]);\n    worksheet.mergeCells(\"A1:E1\");\n    titleRow.getCell(1).fill = {\n        type: \"pattern\",\n        pattern: \"solid\",\n        fgColor: {\n            argb: \"FF4472C4\"\n        }\n    };\n    titleRow.getCell(1).font = {\n        bold: true,\n        color: {\n            argb: \"FFFFFFFF\"\n        },\n        size: 14\n    };\n    titleRow.getCell(1).alignment = {\n        horizontal: \"center\",\n        vertical: \"middle\"\n    };\n    titleRow.height = 25;\n    worksheet.addRow([]); // Linha vazia\n    // Resumo da filial\n    const resumoRow = worksheet.addRow([\n        \"RESUMO DA FILIAL\"\n    ]);\n    worksheet.mergeCells(\"A3:E3\");\n    resumoRow.getCell(1).font = {\n        bold: true,\n        size: 12\n    };\n    resumoRow.getCell(1).fill = {\n        type: \"pattern\",\n        pattern: \"solid\",\n        fgColor: {\n            argb: \"FFE0E0E0\"\n        }\n    };\n    resumoRow.getCell(1).alignment = {\n        horizontal: \"center\"\n    };\n    worksheet.addRow([\n        \"Total A Pagar:\",\n        `R$ ${branch.totalAPagar.toLocaleString(\"pt-BR\", {\n            minimumFractionDigits: 2\n        })}`\n    ]);\n    worksheet.addRow([\n        \"Total A Receber:\",\n        `R$ ${branch.totalAReceber.toLocaleString(\"pt-BR\", {\n            minimumFractionDigits: 2\n        })}`\n    ]);\n    const saldoLiquido = branch.totalAReceber - branch.totalAPagar;\n    const saldoRow = worksheet.addRow([\n        \"Saldo L\\xedquido:\",\n        `R$ ${saldoLiquido.toLocaleString(\"pt-BR\", {\n            minimumFractionDigits: 2\n        })}`\n    ]);\n    // Colorir saldo líquido\n    const saldoCell = saldoRow.getCell(2);\n    if (saldoLiquido > 0) {\n        saldoCell.font = {\n            color: {\n                argb: \"FF008000\"\n            },\n            bold: true\n        }; // Verde\n    } else if (saldoLiquido < 0) {\n        saldoCell.font = {\n            color: {\n                argb: \"FFFF0000\"\n            },\n            bold: true\n        }; // Vermelho\n    }\n    worksheet.addRow([]); // Linha vazia\n    worksheet.addRow([]); // Linha vazia\n    // Detalhamento de transações (se disponível)\n    if (processedData && processedData.transactions.length > 0) {\n        const transactionsHeaderRow = worksheet.addRow([\n            \"DETALHAMENTO DE TRANSA\\xc7\\xd5ES\"\n        ]);\n        worksheet.mergeCells(`A${worksheet.rowCount}:E${worksheet.rowCount}`);\n        transactionsHeaderRow.getCell(1).font = {\n            bold: true,\n            size: 12\n        };\n        transactionsHeaderRow.getCell(1).fill = {\n            type: \"pattern\",\n            pattern: \"solid\",\n            fgColor: {\n                argb: \"FFE0E0E0\"\n            }\n        };\n        transactionsHeaderRow.getCell(1).alignment = {\n            horizontal: \"center\"\n        };\n        worksheet.addRow([]); // Linha vazia\n        // Cabeçalhos das transações\n        const transHeaderRow = worksheet.addRow([\n            \"Vencimento\",\n            \"Transacionador\",\n            \"Documento\",\n            \"Valor\",\n            \"Tipo\"\n        ]);\n        transHeaderRow.font = {\n            bold: true,\n            color: {\n                argb: \"FFFFFFFF\"\n            }\n        };\n        transHeaderRow.fill = {\n            type: \"pattern\",\n            pattern: \"solid\",\n            fgColor: {\n                argb: \"FF4472C4\"\n            }\n        };\n        // Dados das transações\n        processedData.transactions.forEach((transaction)=>{\n            const tipo = transaction.valorNumerico > 0 ? \"A Pagar\" : \"A Receber\";\n            worksheet.addRow([\n                transaction.vencimento,\n                transaction.transacionador,\n                transaction.documento,\n                transaction.valor,\n                tipo\n            ]);\n        });\n    } else {\n        // Mensagem quando não há transações detalhadas\n        const noDataRow = worksheet.addRow([\n            \"TRANSA\\xc7\\xd5ES DETALHADAS\"\n        ]);\n        worksheet.mergeCells(`A${worksheet.rowCount}:E${worksheet.rowCount}`);\n        noDataRow.getCell(1).font = {\n            bold: true,\n            size: 12\n        };\n        noDataRow.getCell(1).fill = {\n            type: \"pattern\",\n            pattern: \"solid\",\n            fgColor: {\n                argb: \"FFE0E0E0\"\n            }\n        };\n        noDataRow.getCell(1).alignment = {\n            horizontal: \"center\"\n        };\n        worksheet.addRow([]); // Linha vazia\n        worksheet.addRow([\n            \"Dados detalhados das transa\\xe7\\xf5es ser\\xe3o exibidos aqui quando dispon\\xedveis.\"\n        ]);\n        worksheet.addRow([\n            \"Para obter detalhes, fa\\xe7a upload dos arquivos CSV individuais.\"\n        ]);\n    }\n    // Ajustar largura das colunas\n    worksheet.columns = [\n        {\n            width: 15\n        },\n        {\n            width: 25\n        },\n        {\n            width: 15\n        },\n        {\n            width: 18\n        },\n        {\n            width: 12\n        } // Tipo\n    ];\n    // Adicionar bordas nas células importantes\n    const allRows = worksheet.getRows(1, worksheet.rowCount);\n    allRows?.forEach((row)=>{\n        row.eachCell((cell)=>{\n            if (cell.value) {\n                cell.border = {\n                    top: {\n                        style: \"thin\"\n                    },\n                    left: {\n                        style: \"thin\"\n                    },\n                    bottom: {\n                        style: \"thin\"\n                    },\n                    right: {\n                        style: \"thin\"\n                    }\n                };\n            }\n        });\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Tzt3QkFBRUgsT0FBTztvQkFBTztnQkFDekI7WUFDRjtRQUNGO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL25vdGFmbGV4LW5leHRqcy8uL3BhZ2VzL2FwaS9leHBvcnQtZXhjZWwudHM/N2RhMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0J1xyXG5pbXBvcnQgRXhjZWxKUyBmcm9tICdleGNlbGpzJ1xyXG5pbXBvcnQgZnMgZnJvbSAnZnMnXHJcblxyXG4vLyBJbnRlcmZhY2UgcGFyYSBkYWRvcyBkZSBpbnZvaWNlIGluZGl2aWR1YWxcclxuaW50ZXJmYWNlIEludm9pY2VEYXRhIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIGJyYW5jaDogc3RyaW5nO1xyXG4gIGludm9pY2VOdW1iZXI6IHN0cmluZztcclxuICBkYXRlOiBEYXRlO1xyXG4gIHZhbHVlOiBzdHJpbmc7XHJcbiAgc3VwcGxpZXI6IHN0cmluZztcclxuICBkb2N1bWVudFR5cGU6ICdBX1BBR0FSJyB8ICdBX1JFQ0VCRVInO1xyXG4gIHNvdXJjZUZpbGU6IHN0cmluZztcclxuICB2YWx1ZU51bWVyaWM6IG51bWJlcjtcclxufVxyXG5cclxuLy8gSW50ZXJmYWNlIHBhcmEgZGFkb3MgZGUgcmVzdW1vIHBvciBmaWxpYWxcclxuaW50ZXJmYWNlIEJyYW5jaERhdGEge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICB0b3RhbEFQYWdhcjogbnVtYmVyO1xyXG4gIHRvdGFsQVJlY2ViZXI6IG51bWJlcjtcclxuICB0b3RhbDogbnVtYmVyO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3VtbWFyeURhdGEge1xyXG4gIGJyYW5jaGVzOiBCcmFuY2hEYXRhW107XHJcbiAgZGF0ZVNwZWNpZmljVG90YWxzOiBBcnJheTx7IGRheTogc3RyaW5nOyB0b3RhbDogbnVtYmVyIH0+O1xyXG4gIGdyYW5kVG90YWw6IG51bWJlcjtcclxuICBncmFuZFRvdGFsQVBhZ2FyOiBudW1iZXI7XHJcbiAgZ3JhbmRUb3RhbEFSZWNlYmVyOiBudW1iZXI7XHJcbn1cclxuXHJcbmludGVyZmFjZSBCcmFuY2hTdW1tYXJ5IHtcclxuICBicmFuY2g6IHN0cmluZztcclxuICBpbnZvaWNlQ291bnQ6IG51bWJlcjtcclxuICB0b3RhbFZhbHVlOiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBUcmFuc2FjdGlvbkRhdGEge1xyXG4gIHZlbmNpbWVudG86IHN0cmluZztcclxuICB0cmFuc2FjaW9uYWRvcjogc3RyaW5nO1xyXG4gIGRvY3VtZW50bzogc3RyaW5nO1xyXG4gIHZhbG9yOiBzdHJpbmc7XHJcbiAgdmFsb3JOdW1lcmljbzogbnVtYmVyO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgUHJvY2Vzc2VkRGF0YSB7XHJcbiAgYnJhbmNoOiBzdHJpbmc7XHJcbiAgdHJhbnNhY3Rpb25zOiBUcmFuc2FjdGlvbkRhdGFbXTtcclxuICB0b3RhbEFQYWdhcjogbnVtYmVyO1xyXG4gIHRvdGFsQVJlY2ViZXI6IG51bWJlcjtcclxuICBzdW1tYXJ5OiBCcmFuY2hEYXRhO1xyXG59XHJcblxyXG4vLyBFc3RpbG9zIEV4Y2VsIG9icmlnYXTDs3Jpb3NcclxuY29uc3QgaGVhZGVyU3R5bGUgPSB7XHJcbiAgZm9udDogeyBib2xkOiB0cnVlLCBjb2xvcjogeyBhcmdiOiAnRkZGRkZGJyB9IH0sXHJcbiAgZmlsbDogeyB0eXBlOiAncGF0dGVybicgYXMgY29uc3QsIHBhdHRlcm46ICdzb2xpZCcgYXMgY29uc3QsIGZnQ29sb3I6IHsgYXJnYjogJzJGNTU5NycgfSB9LFxyXG4gIGFsaWdubWVudDogeyBob3Jpem9udGFsOiAnY2VudGVyJyBhcyBjb25zdCwgdmVydGljYWw6ICdtaWRkbGUnIGFzIGNvbnN0IH0sXHJcbiAgYm9yZGVyOiB7XHJcbiAgICB0b3A6IHsgc3R5bGU6ICd0aGluJyBhcyBjb25zdCB9LFxyXG4gICAgbGVmdDogeyBzdHlsZTogJ3RoaW4nIGFzIGNvbnN0IH0sXHJcbiAgICBib3R0b206IHsgc3R5bGU6ICd0aGluJyBhcyBjb25zdCB9LFxyXG4gICAgcmlnaHQ6IHsgc3R5bGU6ICd0aGluJyBhcyBjb25zdCB9XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3QgY2VsbFN0eWxlID0ge1xyXG4gIGJvcmRlcjoge1xyXG4gICAgdG9wOiB7IHN0eWxlOiAndGhpbicgYXMgY29uc3QgfSxcclxuICAgIGxlZnQ6IHsgc3R5bGU6ICd0aGluJyBhcyBjb25zdCB9LFxyXG4gICAgYm90dG9tOiB7IHN0eWxlOiAndGhpbicgYXMgY29uc3QgfSxcclxuICAgIHJpZ2h0OiB7IHN0eWxlOiAndGhpbicgYXMgY29uc3QgfVxyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IHRpdGxlU3R5bGUgPSB7XHJcbiAgZm9udDogeyBib2xkOiB0cnVlLCBzaXplOiAxNiwgY29sb3I6IHsgYXJnYjogJ0ZGRkZGRicgfSB9LFxyXG4gIGFsaWdubWVudDogeyBob3Jpem9udGFsOiAnY2VudGVyJyBhcyBjb25zdCwgdmVydGljYWw6ICdtaWRkbGUnIGFzIGNvbnN0IH0sXHJcbiAgZmlsbDogeyB0eXBlOiAncGF0dGVybicgYXMgY29uc3QsIHBhdHRlcm46ICdzb2xpZCcgYXMgY29uc3QsIGZnQ29sb3I6IHsgYXJnYjogJzJGNTU5NycgfSB9XHJcbn07XHJcblxyXG5jb25zdCBzdWJIZWFkZXJTdHlsZSA9IHtcclxuICBmb250OiB7IGJvbGQ6IHRydWUsIHNpemU6IDE0LCBjb2xvcjogeyBhcmdiOiAnRkZGRkZGJyB9IH0sXHJcbiAgZmlsbDogeyB0eXBlOiAncGF0dGVybicgYXMgY29uc3QsIHBhdHRlcm46ICdzb2xpZCcgYXMgY29uc3QsIGZnQ29sb3I6IHsgYXJnYjogJzFGNEU3OScgfSB9LFxyXG4gIGFsaWdubWVudDogeyBob3Jpem9udGFsOiAnY2VudGVyJyBhcyBjb25zdCwgdmVydGljYWw6ICdtaWRkbGUnIGFzIGNvbnN0IH1cclxufTtcclxuXHJcbmNvbnN0IHRvdGFsUm93U3R5bGUgPSB7XHJcbiAgZm9udDogeyBib2xkOiB0cnVlLCBjb2xvcjogeyBhcmdiOiAnRkZGRkZGJyB9IH0sXHJcbiAgZmlsbDogeyB0eXBlOiAncGF0dGVybicgYXMgY29uc3QsIHBhdHRlcm46ICdzb2xpZCcgYXMgY29uc3QsIGZnQ29sb3I6IHsgYXJnYjogJzM2NjA5MicgfSB9LFxyXG4gIGFsaWdubWVudDogeyBob3Jpem9udGFsOiAnY2VudGVyJyBhcyBjb25zdCwgdmVydGljYWw6ICdtaWRkbGUnIGFzIGNvbnN0IH1cclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIoXHJcbiAgcmVxOiBOZXh0QXBpUmVxdWVzdCxcclxuICByZXM6IE5leHRBcGlSZXNwb25zZVxyXG4pIHtcclxuICBjb25zb2xlLmxvZygnSW5pY2lhbmRvIGdlcmHDp8OjbyBkbyBFeGNlbC4uLicpXHJcbiAgY29uc29sZS5sb2coJ01ldGhvZDonLCByZXEubWV0aG9kKVxyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICAvLyBFeHRyYWlyIGluZm9ybWHDp8O1ZXMgZG8gcmVsYXTDs3Jpb1xyXG4gICAgY29uc3QgeyBuYW1lOiByZXBvcnROYW1lLCBzdGFydERhdGUsIGVuZERhdGUsIGNhdGVnb3JpZXMgfSA9IHJlcS5ib2R5IHx8IHt9O1xyXG4gICAgXHJcbiAgICBsZXQgc3VtbWFyeURhdGE6IFN1bW1hcnlEYXRhIHwgbnVsbCA9IG51bGw7XHJcbiAgICBsZXQgYWxsSW52b2ljZXM6IEludm9pY2VEYXRhW10gPSBbXTtcclxuICAgIGxldCBhbGxCcmFuY2hTdW1tYXJpZXM6IEJyYW5jaFN1bW1hcnlbXSA9IFtdO1xyXG5cclxuICAgIC8vIFZlcmlmaWNhciBzZSBleGlzdGUgZGFkb3MgZGUgcmVzdW1vIGVtIHNlc3PDo28vY2FjaGUgb3UgdXNhciBkYWRvcyBoYXJkY29kZWRcclxuICAgIGlmIChyZXEubWV0aG9kID09PSAnUE9TVCcgJiYgcmVxLmJvZHkpIHtcclxuICAgICAgY29uc29sZS5sb2coJ0RhZG9zIHJlY2ViaWRvcyBubyBib2R5OicsIHJlcS5ib2R5KTtcclxuICAgICAgXHJcbiAgICAgIGlmIChyZXEuYm9keS5zdW1tYXJ5RGF0YSkge1xyXG4gICAgICAgIHN1bW1hcnlEYXRhID0gcmVxLmJvZHkuc3VtbWFyeURhdGE7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGlmIChyZXEuYm9keS5hbGxJbnZvaWNlcykge1xyXG4gICAgICAgIGFsbEludm9pY2VzID0gcmVxLmJvZHkuYWxsSW52b2ljZXM7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGlmIChyZXEuYm9keS5hbGxCcmFuY2hTdW1tYXJpZXMpIHtcclxuICAgICAgICBhbGxCcmFuY2hTdW1tYXJpZXMgPSByZXEuYm9keS5hbGxCcmFuY2hTdW1tYXJpZXM7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBTZSBuw6NvIHRlbW9zIGRhZG9zLCB1c2FyIGRhZG9zIGhhcmRjb2RlZCBwYXJhIGRlbW9uc3RyYcOnw6NvXHJcbiAgICBpZiAoIXN1bW1hcnlEYXRhIHx8IHN1bW1hcnlEYXRhLmJyYW5jaGVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnVXNhbmRvIGRhZG9zIGhhcmRjb2RlZCBwYXJhIGRlbW9uc3RyYcOnw6NvJyk7XHJcbiAgICAgIHN1bW1hcnlEYXRhID0ge1xyXG4gICAgICAgIGJyYW5jaGVzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIG5hbWU6ICdHTyBTRUVEUycsXHJcbiAgICAgICAgICAgIHRvdGFsQVBhZ2FyOiAxOTEyMDQwLjAwLFxyXG4gICAgICAgICAgICB0b3RhbEFSZWNlYmVyOiAzMTc1OTkwLjM2LFxyXG4gICAgICAgICAgICB0b3RhbDogNTA4NzAzMC4zNlxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgbmFtZTogJ0JFSUpBIEZMT1InLFxyXG4gICAgICAgICAgICB0b3RhbEFQYWdhcjogMTI5NzYzLjI0LFxyXG4gICAgICAgICAgICB0b3RhbEFSZWNlYmVyOiAwLjAwLFxyXG4gICAgICAgICAgICB0b3RhbDogMTI5NzYzLjI0XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBuYW1lOiAnU0FHVUlBJyxcclxuICAgICAgICAgICAgdG90YWxBUGFnYXI6IDEzODI1MS4xMCxcclxuICAgICAgICAgICAgdG90YWxBUmVjZWJlcjogMC4wMCxcclxuICAgICAgICAgICAgdG90YWw6IDEzODI1MS4xMFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgbmFtZTogJ1VMVFJBIFNFRURTJyxcclxuICAgICAgICAgICAgdG90YWxBUGFnYXI6IDgwLjk2LFxyXG4gICAgICAgICAgICB0b3RhbEFSZWNlYmVyOiAwLjAwLFxyXG4gICAgICAgICAgICB0b3RhbDogODAuOTZcclxuICAgICAgICAgIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIGRhdGVTcGVjaWZpY1RvdGFsczogW1xyXG4gICAgICAgICAgeyBkYXk6ICcxNS8wOS8yMDI0JywgdG90YWw6IDUwMDAwMC4wMCB9LFxyXG4gICAgICAgICAgeyBkYXk6ICcxNi8wOS8yMDI0JywgdG90YWw6IDc1MDAwMC4wMCB9LFxyXG4gICAgICAgICAgeyBkYXk6ICcxNy8wOS8yMDI0JywgdG90YWw6IDk1MDAwMC4wMCB9XHJcbiAgICAgICAgXSxcclxuICAgICAgICBncmFuZFRvdGFsOiA1MzU1MTM1LjY2LFxyXG4gICAgICAgIGdyYW5kVG90YWxBUGFnYXI6IDIxODAxMzUuMzAsXHJcbiAgICAgICAgZ3JhbmRUb3RhbEFSZWNlYmVyOiAzMTc1MDAwLjM2XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBHZXJhciBkYWRvcyBkZSBpbnZvaWNlcyBzaW11bGFkb3MgYmFzZWFkb3Mgbm8gc3VtbWFyeURhdGFcclxuICAgICAgYWxsSW52b2ljZXMgPSBnZW5lcmF0ZVNpbXVsYXRlZEludm9pY2VzKHN1bW1hcnlEYXRhKTtcclxuICAgICAgYWxsQnJhbmNoU3VtbWFyaWVzID0gc3VtbWFyeURhdGEuYnJhbmNoZXMubWFwKGJyYW5jaCA9PiAoe1xyXG4gICAgICAgIGJyYW5jaDogYnJhbmNoLm5hbWUsXHJcbiAgICAgICAgaW52b2ljZUNvdW50OiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCkgKyA1LFxyXG4gICAgICAgIHRvdGFsVmFsdWU6IGJyYW5jaC50b3RhbC50b0xvY2FsZVN0cmluZygncHQtQlInLCB7IHN0eWxlOiAnY3VycmVuY3knLCBjdXJyZW5jeTogJ0JSTCcgfSlcclxuICAgICAgfSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENhbGN1bGFyIHBlcsOtb2RvIHJlYWwgYmFzZWFkbyBuYXMgZGF0YXMgZG9zIGRvY3VtZW50b3NcclxuICAgIGxldCBhY3R1YWxTdGFydERhdGU6IERhdGU7XHJcbiAgICBsZXQgYWN0dWFsRW5kRGF0ZTogRGF0ZTtcclxuICAgIFxyXG4gICAgaWYgKGFsbEludm9pY2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc3QgaW52b2ljZURhdGVzID0gYWxsSW52b2ljZXNcclxuICAgICAgICAubWFwKGludiA9PiBuZXcgRGF0ZShpbnYuZGF0ZSkpXHJcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IGEuZ2V0VGltZSgpIC0gYi5nZXRUaW1lKCkpO1xyXG4gICAgICBhY3R1YWxTdGFydERhdGUgPSBpbnZvaWNlRGF0ZXNbMF07XHJcbiAgICAgIGFjdHVhbEVuZERhdGUgPSBpbnZvaWNlRGF0ZXNbaW52b2ljZURhdGVzLmxlbmd0aCAtIDFdO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYWN0dWFsU3RhcnREYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgYWN0dWFsRW5kRGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ3JpYXIgd29ya2Jvb2tcclxuICAgIGNvbnN0IHdvcmtib29rID0gbmV3IEV4Y2VsSlMuV29ya2Jvb2soKTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ0NyaWFuZG8gYWJhIGRlIFJlc3VtbyBHZXJhbC4uLicpO1xyXG4gICAgYXdhaXQgY3JlYXRlQWR2YW5jZWRTdW1tYXJ5V29ya3NoZWV0KFxyXG4gICAgICB3b3JrYm9vaywgXHJcbiAgICAgIHN1bW1hcnlEYXRhLCBcclxuICAgICAgYWxsSW52b2ljZXMsIFxyXG4gICAgICByZXBvcnROYW1lIHx8ICdSZWxhdMOzcmlvIGRlIE5vdGFzIEZpc2NhaXMnLFxyXG4gICAgICBhY3R1YWxTdGFydERhdGUsXHJcbiAgICAgIGFjdHVhbEVuZERhdGVcclxuICAgICk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKCdDcmlhbmRvIGFiYXMgaW5kaXZpZHVhaXMgcG9yIGZpbGlhbC4uLicpO1xyXG4gICAgZm9yIChjb25zdCBicmFuY2ggb2Ygc3VtbWFyeURhdGEuYnJhbmNoZXMpIHtcclxuICAgICAgY29uc3QgYnJhbmNoSW52b2ljZXMgPSBhbGxJbnZvaWNlcy5maWx0ZXIoaW52ID0+IGludi5icmFuY2ggPT09IGJyYW5jaC5uYW1lKTtcclxuICAgICAgYXdhaXQgY3JlYXRlQWR2YW5jZWRCcmFuY2hXb3Jrc2hlZXQod29ya2Jvb2ssIGJyYW5jaCwgYnJhbmNoSW52b2ljZXMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENvbmZpZ3VyYXIgcmVzcG9zdGEgSFRUUFxyXG4gICAgY29uc3QgZmlsZU5hbWUgPSBgcmVsYXRvcmlvX2RldGFsaGFkb18ke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdfS54bHN4YDtcclxuICAgIHJlcy5zZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQuc3ByZWFkc2hlZXRtbC5zaGVldCcpO1xyXG4gICAgcmVzLnNldEhlYWRlcignQ29udGVudC1EaXNwb3NpdGlvbicsIGBhdHRhY2htZW50OyBmaWxlbmFtZT1cIiR7ZmlsZU5hbWV9XCJgKTtcclxuICAgIFxyXG4gICAgLy8gRXNjcmV2ZXIgd29ya2Jvb2sgbmEgcmVzcG9zdGFcclxuICAgIGF3YWl0IHdvcmtib29rLnhsc3gud3JpdGUocmVzKTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ0V4Y2VsIGdlcmFkbyBjb20gc3VjZXNzbyEnKTtcclxuICAgIHJlcy5lbmQoKTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gbmEgZ2VyYcOnw6NvIGRvIEV4Y2VsOicsIGVycm9yKTtcclxuICAgIGlmICghcmVzLmhlYWRlcnNTZW50KSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsIFxyXG4gICAgICAgIG1lc3NhZ2U6ICdFcnJvIGludGVybm8gZG8gc2Vydmlkb3I6ICcgKyAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRXJybyBkZXNjb25oZWNpZG8nKVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8vIEZ1bsOnw6NvIHBhcmEgZ2VyYXIgZGFkb3MgZGUgaW52b2ljZXMgc2ltdWxhZG9zXHJcbmZ1bmN0aW9uIGdlbmVyYXRlU2ltdWxhdGVkSW52b2ljZXMoc3VtbWFyeURhdGE6IFN1bW1hcnlEYXRhKTogSW52b2ljZURhdGFbXSB7XHJcbiAgY29uc3QgaW52b2ljZXM6IEludm9pY2VEYXRhW10gPSBbXTtcclxuICBsZXQgaWRDb3VudGVyID0gMTtcclxuICBcclxuICBzdW1tYXJ5RGF0YS5icmFuY2hlcy5mb3JFYWNoKGJyYW5jaCA9PiB7XHJcbiAgICAvLyBHZXJhciBhbGd1bWFzIGludm9pY2VzIEFfUEFHQVJcclxuICAgIGlmIChicmFuY2gudG90YWxBUGFnYXIgPiAwKSB7XHJcbiAgICAgIGNvbnN0IG51bUludm9pY2VzQVBhZ2FyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNSkgKyAyO1xyXG4gICAgICBjb25zdCBhdmVyYWdlVmFsdWUgPSBicmFuY2gudG90YWxBUGFnYXIgLyBudW1JbnZvaWNlc0FQYWdhcjtcclxuICAgICAgXHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtSW52b2ljZXNBUGFnYXI7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXZlcmFnZVZhbHVlICogKDAuOCArIE1hdGgucmFuZG9tKCkgKiAwLjQpOyAvLyBWYXJpYcOnw6NvIGRlIMKxMjAlXHJcbiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgZGF0ZS5zZXREYXRlKGRhdGUuZ2V0RGF0ZSgpICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMzApKTsgLy8gUHLDs3hpbW9zIDMwIGRpYXNcclxuICAgICAgICBcclxuICAgICAgICBpbnZvaWNlcy5wdXNoKHtcclxuICAgICAgICAgIGlkOiBgaW52XyR7aWRDb3VudGVyKyt9YCxcclxuICAgICAgICAgIGJyYW5jaDogYnJhbmNoLm5hbWUsXHJcbiAgICAgICAgICBpbnZvaWNlTnVtYmVyOiBgTkYtJHtTdHJpbmcoaSArIDEpLnBhZFN0YXJ0KDMsICcwJyl9YCxcclxuICAgICAgICAgIGRhdGU6IGRhdGUsXHJcbiAgICAgICAgICB2YWx1ZTogdmFsdWUudG9Mb2NhbGVTdHJpbmcoJ3B0LUJSJywgeyBzdHlsZTogJ2N1cnJlbmN5JywgY3VycmVuY3k6ICdCUkwnIH0pLFxyXG4gICAgICAgICAgc3VwcGxpZXI6IGBGT1JORUNFRE9SICR7U3RyaW5nLmZyb21DaGFyQ29kZSg2NSArIGkpfWAsXHJcbiAgICAgICAgICBkb2N1bWVudFR5cGU6ICdBX1BBR0FSJyxcclxuICAgICAgICAgIHNvdXJjZUZpbGU6IGAke2JyYW5jaC5uYW1lfS5jc3ZgLFxyXG4gICAgICAgICAgdmFsdWVOdW1lcmljOiB2YWx1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEdlcmFyIGFsZ3VtYXMgaW52b2ljZXMgQV9SRUNFQkVSXHJcbiAgICBpZiAoYnJhbmNoLnRvdGFsQVJlY2ViZXIgPiAwKSB7XHJcbiAgICAgIGNvbnN0IG51bUludm9pY2VzQVJlY2ViZXIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKSArIDE7XHJcbiAgICAgIGNvbnN0IGF2ZXJhZ2VWYWx1ZSA9IGJyYW5jaC50b3RhbEFSZWNlYmVyIC8gbnVtSW52b2ljZXNBUmVjZWJlcjtcclxuICAgICAgXHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtSW52b2ljZXNBUmVjZWJlcjsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSBhdmVyYWdlVmFsdWUgKiAoMC44ICsgTWF0aC5yYW5kb20oKSAqIDAuNCk7XHJcbiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgZGF0ZS5zZXREYXRlKGRhdGUuZ2V0RGF0ZSgpICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMzApKTtcclxuICAgICAgICBcclxuICAgICAgICBpbnZvaWNlcy5wdXNoKHtcclxuICAgICAgICAgIGlkOiBgaW52XyR7aWRDb3VudGVyKyt9YCxcclxuICAgICAgICAgIGJyYW5jaDogYnJhbmNoLm5hbWUsXHJcbiAgICAgICAgICBpbnZvaWNlTnVtYmVyOiBgUkVDLSR7U3RyaW5nKGkgKyAxKS5wYWRTdGFydCgzLCAnMCcpfWAsXHJcbiAgICAgICAgICBkYXRlOiBkYXRlLFxyXG4gICAgICAgICAgdmFsdWU6IHZhbHVlLnRvTG9jYWxlU3RyaW5nKCdwdC1CUicsIHsgc3R5bGU6ICdjdXJyZW5jeScsIGN1cnJlbmN5OiAnQlJMJyB9KSxcclxuICAgICAgICAgIHN1cHBsaWVyOiBgQ0xJRU5URSAke1N0cmluZy5mcm9tQ2hhckNvZGUoNjUgKyBpKX1gLFxyXG4gICAgICAgICAgZG9jdW1lbnRUeXBlOiAnQV9SRUNFQkVSJyxcclxuICAgICAgICAgIHNvdXJjZUZpbGU6IGAke2JyYW5jaC5uYW1lfS5jc3ZgLFxyXG4gICAgICAgICAgdmFsdWVOdW1lcmljOiB2YWx1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgXHJcbiAgcmV0dXJuIGludm9pY2VzO1xyXG59XHJcblxyXG4vLyBGdW7Dp8OjbyBwYXJhIGNyaWFyIGEgYWJhIGRlIHJlc3VtbyBnZXJhbCBhdmFuw6dhZGFcclxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlQWR2YW5jZWRTdW1tYXJ5V29ya3NoZWV0KFxyXG4gIHdvcmtib29rOiBFeGNlbEpTLldvcmtib29rLCBcclxuICBzdW1tYXJ5RGF0YTogU3VtbWFyeURhdGEsIFxyXG4gIGFsbEludm9pY2VzOiBJbnZvaWNlRGF0YVtdLFxyXG4gIHJlcG9ydE5hbWU6IHN0cmluZyxcclxuICBhY3R1YWxTdGFydERhdGU6IERhdGUsXHJcbiAgYWN0dWFsRW5kRGF0ZTogRGF0ZVxyXG4pIHtcclxuICBjb25zdCBzdW1tYXJ5U2hlZXQgPSB3b3JrYm9vay5hZGRXb3Jrc2hlZXQoJ1Jlc3VtbyBHZXJhbCcpO1xyXG4gIGxldCBzdW1tYXJ5Q3VycmVudFJvdyA9IDE7XHJcblxyXG4gIC8vIEhlYWRlciBkbyByZWxhdMOzcmlvXHJcbiAgc3VtbWFyeVNoZWV0LmFkZFJvdyhbcmVwb3J0TmFtZV0pO1xyXG4gIHN1bW1hcnlTaGVldC5tZXJnZUNlbGxzKGBBJHtzdW1tYXJ5Q3VycmVudFJvd306RCR7c3VtbWFyeUN1cnJlbnRSb3d9YCk7XHJcbiAgc3VtbWFyeVNoZWV0LmdldENlbGwoYEEke3N1bW1hcnlDdXJyZW50Um93fWApLnN0eWxlID0gdGl0bGVTdHlsZTtcclxuICBzdW1tYXJ5U2hlZXQuZ2V0Um93KHN1bW1hcnlDdXJyZW50Um93KS5oZWlnaHQgPSAzNTtcclxuICBzdW1tYXJ5Q3VycmVudFJvdysrO1xyXG5cclxuICAvLyBQZXLDrW9kb1xyXG4gIGNvbnN0IHBlcmlvZFRleHQgPSBgUEVSw41PRE86ICR7YWN0dWFsU3RhcnREYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygncHQtQlInKX0gLSAke2FjdHVhbEVuZERhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCdwdC1CUicpfWA7XHJcbiAgc3VtbWFyeVNoZWV0LmFkZFJvdyhbcGVyaW9kVGV4dF0pO1xyXG4gIHN1bW1hcnlTaGVldC5tZXJnZUNlbGxzKGBBJHtzdW1tYXJ5Q3VycmVudFJvd306RCR7c3VtbWFyeUN1cnJlbnRSb3d9YCk7XHJcbiAgc3VtbWFyeVNoZWV0LmdldENlbGwoYEEke3N1bW1hcnlDdXJyZW50Um93fWApLnN0eWxlID0ge1xyXG4gICAgZm9udDogeyBib2xkOiB0cnVlLCBzaXplOiAxMiB9LFxyXG4gICAgZmlsbDogeyB0eXBlOiAncGF0dGVybicgYXMgY29uc3QsIHBhdHRlcm46ICdzb2xpZCcgYXMgY29uc3QsIGZnQ29sb3I6IHsgYXJnYjogJ0U3RTZFNicgfSB9LFxyXG4gICAgYWxpZ25tZW50OiB7IGhvcml6b250YWw6ICdjZW50ZXInIGFzIGNvbnN0LCB2ZXJ0aWNhbDogJ21pZGRsZScgYXMgY29uc3QgfVxyXG4gIH07XHJcbiAgc3VtbWFyeUN1cnJlbnRSb3crKztcclxuXHJcbiAgLy8gTGluaGEgdmF6aWFcclxuICBzdW1tYXJ5U2hlZXQuYWRkUm93KFtdKTtcclxuICBzdW1tYXJ5Q3VycmVudFJvdysrO1xyXG5cclxuICAvLyBIZWFkZXJzIGRhcyBjb2x1bmFzXHJcbiAgc3VtbWFyeVNoZWV0LmFkZFJvdyhbJ1ZlbmNpbWVudG8nLCAnVHJhbnNhY2lvbmFkb3InLCAnRG9jdW1lbnRvJywgJ1ZhbG9yJ10pO1xyXG4gIHN1bW1hcnlTaGVldC5nZXRSb3coc3VtbWFyeUN1cnJlbnRSb3cpLmVhY2hDZWxsKChjZWxsKSA9PiB7XHJcbiAgICBjZWxsLnN0eWxlID0gaGVhZGVyU3R5bGU7XHJcbiAgfSk7XHJcbiAgc3VtbWFyeUN1cnJlbnRSb3crKztcclxuXHJcbiAgLy8gQWdydXBhciBpbnZvaWNlcyBwb3IgYXJxdWl2byBmb250ZSBlIHRpcG8gZGUgZG9jdW1lbnRvXHJcbiAgY29uc3QgaW52b2ljZXNCeUZpbGVBbmRUeXBlID0gbmV3IE1hcDxzdHJpbmcsIHsgQV9QQUdBUjogSW52b2ljZURhdGFbXSwgQV9SRUNFQkVSOiBJbnZvaWNlRGF0YVtdIH0+KCk7XHJcbiAgXHJcbiAgZm9yIChjb25zdCBpbnZvaWNlIG9mIGFsbEludm9pY2VzKSB7XHJcbiAgICBjb25zdCBzb3VyY2VGaWxlID0gaW52b2ljZS5zb3VyY2VGaWxlIHx8ICdVbmtub3duJztcclxuICAgIFxyXG4gICAgaWYgKCFpbnZvaWNlc0J5RmlsZUFuZFR5cGUuaGFzKHNvdXJjZUZpbGUpKSB7XHJcbiAgICAgIGludm9pY2VzQnlGaWxlQW5kVHlwZS5zZXQoc291cmNlRmlsZSwgeyBBX1BBR0FSOiBbXSwgQV9SRUNFQkVSOiBbXSB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgZmlsZVR5cGVzID0gaW52b2ljZXNCeUZpbGVBbmRUeXBlLmdldChzb3VyY2VGaWxlKSE7XHJcbiAgICBjb25zdCBkb2NUeXBlID0gaW52b2ljZS5kb2N1bWVudFR5cGUgfHwgJ0FfUEFHQVInO1xyXG4gICAgZmlsZVR5cGVzW2RvY1R5cGVdLnB1c2goaW52b2ljZSk7XHJcbiAgfVxyXG5cclxuICAvLyBQcm9jZXNzYXIgY2FkYSBhcnF1aXZvIGUgdGlwbyBkZSBkb2N1bWVudG9cclxuICBmb3IgKGNvbnN0IFtmaWxlTmFtZSwgZmlsZVR5cGVzXSBvZiBBcnJheS5mcm9tKGludm9pY2VzQnlGaWxlQW5kVHlwZSkpIHtcclxuICAgIGZvciAoY29uc3QgW2RvY1R5cGUsIGZpbGVJbnZvaWNlc10gb2YgT2JqZWN0LmVudHJpZXMoZmlsZVR5cGVzKSkge1xyXG4gICAgICBpZiAoZmlsZUludm9pY2VzLmxlbmd0aCA9PT0gMCkgY29udGludWU7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCB0eXBlTGFiZWwgPSBkb2NUeXBlID09PSAnQV9QQUdBUicgPyAnQ09OVEFTIEEgUEFHQVInIDogJ0NPTlRBUyBBIFJFQ0VCRVInO1xyXG4gICAgICBjb25zdCBjbGVhbkZpbGVOYW1lID0gZmlsZU5hbWUucmVwbGFjZSgvXFwuKGNzdnxDU1YpJC8sICcnKTtcclxuICAgICAgXHJcbiAgICAgIC8vIEhlYWRlciBkYSBjYXRlZ29yaWFcclxuICAgICAgc3VtbWFyeVNoZWV0LmFkZFJvdyhbYCR7dHlwZUxhYmVsfSAtICR7Y2xlYW5GaWxlTmFtZX1gLCAnJywgJycsICcnXSk7XHJcbiAgICAgIHN1bW1hcnlTaGVldC5tZXJnZUNlbGxzKGBBJHtzdW1tYXJ5Q3VycmVudFJvd306RCR7c3VtbWFyeUN1cnJlbnRSb3d9YCk7XHJcbiAgICAgIHN1bW1hcnlTaGVldC5nZXRDZWxsKGBBJHtzdW1tYXJ5Q3VycmVudFJvd31gKS5zdHlsZSA9IHN1YkhlYWRlclN0eWxlO1xyXG4gICAgICBzdW1tYXJ5Q3VycmVudFJvdysrO1xyXG4gICAgICBcclxuICAgICAgLy8gT3JkZW5hciBwb3IgZGF0YVxyXG4gICAgICBmaWxlSW52b2ljZXMuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYS5kYXRlKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShiLmRhdGUpLmdldFRpbWUoKSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBBZGljaW9uYXIgdHJhbnNhw6fDtWVzIGNvbSB0b3RhaXMgZGnDoXJpb3NcclxuICAgICAgbGV0IGN1cnJlbnREYXRlID0gJyc7XHJcbiAgICAgIGxldCBkYWlseVRvdGFsID0gMDtcclxuICAgICAgXHJcbiAgICAgIGZvciAoY29uc3QgaW52b2ljZSBvZiBmaWxlSW52b2ljZXMpIHtcclxuICAgICAgICBjb25zdCBpbnZvaWNlRGF0ZSA9IG5ldyBEYXRlKGludm9pY2UuZGF0ZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCdwdC1CUicpO1xyXG4gICAgICAgIGNvbnN0IGludm9pY2VWYWx1ZSA9IGludm9pY2UudmFsdWVOdW1lcmljO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFZlcmlmaWNhciBtdWRhbsOnYSBkZSBkYXRhIHBhcmEgdG90YWwgZGnDoXJpb1xyXG4gICAgICAgIGlmIChjdXJyZW50RGF0ZSAmJiBjdXJyZW50RGF0ZSAhPT0gaW52b2ljZURhdGUgJiYgZGFpbHlUb3RhbCA+IDApIHtcclxuICAgICAgICAgIHN1bW1hcnlTaGVldC5hZGRSb3coWycnLCAnJywgJ1RPVEFMIERJw4FSSU8nLCBkYWlseVRvdGFsXSk7XHJcbiAgICAgICAgICBjb25zdCB0b3RhbFJvdyA9IHN1bW1hcnlTaGVldC5nZXRSb3coc3VtbWFyeUN1cnJlbnRSb3cpO1xyXG4gICAgICAgICAgdG90YWxSb3cuZWFjaENlbGwoKGNlbGwsIGNvbE51bWJlcikgPT4ge1xyXG4gICAgICAgICAgICBjZWxsLnN0eWxlID0ge1xyXG4gICAgICAgICAgICAgIGZvbnQ6IHsgYm9sZDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgIGZpbGw6IHsgdHlwZTogJ3BhdHRlcm4nIGFzIGNvbnN0LCBwYXR0ZXJuOiAnc29saWQnIGFzIGNvbnN0LCBmZ0NvbG9yOiB7IGFyZ2I6ICdGMkYyRjInIH0gfSxcclxuICAgICAgICAgICAgICBudW1GbXQ6IGNvbE51bWJlciA9PT0gNCA/ICdSJCAjLCMjMC4wMCcgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgYm9yZGVyOiBjZWxsU3R5bGUuYm9yZGVyXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHN1bW1hcnlDdXJyZW50Um93Kys7XHJcbiAgICAgICAgICBkYWlseVRvdGFsID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQWRpY2lvbmFyIGxpbmhhIGRhIHRyYW5zYcOnw6NvXHJcbiAgICAgICAgc3VtbWFyeVNoZWV0LmFkZFJvdyhbXHJcbiAgICAgICAgICBpbnZvaWNlRGF0ZSxcclxuICAgICAgICAgIGludm9pY2Uuc3VwcGxpZXIgfHwgJ0ZPUk5FQ0VET1IgTsODTyBJREVOVElGSUNBRE8nLFxyXG4gICAgICAgICAgaW52b2ljZS5pbnZvaWNlTnVtYmVyLFxyXG4gICAgICAgICAgaW52b2ljZVZhbHVlXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3Qgcm93ID0gc3VtbWFyeVNoZWV0LmdldFJvdyhzdW1tYXJ5Q3VycmVudFJvdyk7XHJcbiAgICAgICAgcm93LmVhY2hDZWxsKChjZWxsLCBjb2xOdW1iZXIpID0+IHtcclxuICAgICAgICAgIGNlbGwuc3R5bGUgPSBjZWxsU3R5bGU7XHJcbiAgICAgICAgICBpZiAoY29sTnVtYmVyID09PSA0KSB7XHJcbiAgICAgICAgICAgIGNlbGwubnVtRm10ID0gJ1IkICMsIyMwLjAwJztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBjdXJyZW50RGF0ZSA9IGludm9pY2VEYXRlO1xyXG4gICAgICAgIGRhaWx5VG90YWwgKz0gaW52b2ljZVZhbHVlO1xyXG4gICAgICAgIHN1bW1hcnlDdXJyZW50Um93Kys7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIFRvdGFsIGZpbmFsIGRhIGNhdGVnb3JpYSBzZSBob3V2ZXIgZGFkb3MgcGVuZGVudGVzXHJcbiAgICAgIGlmIChkYWlseVRvdGFsID4gMCkge1xyXG4gICAgICAgIHN1bW1hcnlTaGVldC5hZGRSb3coWycnLCAnJywgJ1RPVEFMIERJw4FSSU8nLCBkYWlseVRvdGFsXSk7XHJcbiAgICAgICAgY29uc3QgdG90YWxSb3cgPSBzdW1tYXJ5U2hlZXQuZ2V0Um93KHN1bW1hcnlDdXJyZW50Um93KTtcclxuICAgICAgICB0b3RhbFJvdy5lYWNoQ2VsbCgoY2VsbCwgY29sTnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICBjZWxsLnN0eWxlID0ge1xyXG4gICAgICAgICAgICBmb250OiB7IGJvbGQ6IHRydWUgfSxcclxuICAgICAgICAgICAgZmlsbDogeyB0eXBlOiAncGF0dGVybicgYXMgY29uc3QsIHBhdHRlcm46ICdzb2xpZCcgYXMgY29uc3QsIGZnQ29sb3I6IHsgYXJnYjogJ0YyRjJGMicgfSB9LFxyXG4gICAgICAgICAgICBudW1GbXQ6IGNvbE51bWJlciA9PT0gNCA/ICdSJCAjLCMjMC4wMCcgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIGJvcmRlcjogY2VsbFN0eWxlLmJvcmRlclxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBzdW1tYXJ5Q3VycmVudFJvdysrO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBUb3RhbCBkYSBjYXRlZ29yaWFcclxuICAgICAgY29uc3QgY2F0ZWdvcnlUb3RhbCA9IGZpbGVJbnZvaWNlcy5yZWR1Y2UoKHN1bSwgaW52KSA9PiBzdW0gKyBpbnYudmFsdWVOdW1lcmljLCAwKTtcclxuICAgICAgc3VtbWFyeVNoZWV0LmFkZFJvdyhbJycsICcnLCBgVE9UQUwgJHt0eXBlTGFiZWx9YCwgY2F0ZWdvcnlUb3RhbF0pO1xyXG4gICAgICBjb25zdCBjYXRlZ29yeVRvdGFsUm93ID0gc3VtbWFyeVNoZWV0LmdldFJvdyhzdW1tYXJ5Q3VycmVudFJvdyk7XHJcbiAgICAgIGNhdGVnb3J5VG90YWxSb3cuZWFjaENlbGwoKGNlbGwsIGNvbE51bWJlcikgPT4ge1xyXG4gICAgICAgIGNlbGwuc3R5bGUgPSB7XHJcbiAgICAgICAgICAuLi50b3RhbFJvd1N0eWxlLFxyXG4gICAgICAgICAgbnVtRm10OiBjb2xOdW1iZXIgPT09IDQgPyAnUiQgIywjIzAuMDAnIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgYm9yZGVyOiBjZWxsU3R5bGUuYm9yZGVyXHJcbiAgICAgICAgfTtcclxuICAgICAgfSk7XHJcbiAgICAgIHN1bW1hcnlDdXJyZW50Um93Kys7XHJcbiAgICAgIFxyXG4gICAgICAvLyBMaW5oYSB2YXppYSBwYXJhIHNlcGFyYcOnw6NvXHJcbiAgICAgIHN1bW1hcnlTaGVldC5hZGRSb3coW10pO1xyXG4gICAgICBzdW1tYXJ5Q3VycmVudFJvdysrO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gVG90YWwgZ2VyYWwgZmluYWxcclxuICBzdW1tYXJ5U2hlZXQuYWRkUm93KFsnJywgJycsICdUT1RBTCBHRVJBTCcsIHN1bW1hcnlEYXRhLmdyYW5kVG90YWxdKTtcclxuICBjb25zdCBncmFuZFRvdGFsUm93ID0gc3VtbWFyeVNoZWV0LmdldFJvdyhzdW1tYXJ5Q3VycmVudFJvdyk7XHJcbiAgZ3JhbmRUb3RhbFJvdy5lYWNoQ2VsbCgoY2VsbCwgY29sTnVtYmVyKSA9PiB7XHJcbiAgICBjZWxsLnN0eWxlID0ge1xyXG4gICAgICAuLi50b3RhbFJvd1N0eWxlLFxyXG4gICAgICBudW1GbXQ6IGNvbE51bWJlciA9PT0gNCA/ICdSJCAjLCMjMC4wMCcgOiB1bmRlZmluZWQsXHJcbiAgICAgIGJvcmRlcjogY2VsbFN0eWxlLmJvcmRlcixcclxuICAgICAgZm9udDogeyBib2xkOiB0cnVlLCBzaXplOiAxNCwgY29sb3I6IHsgYXJnYjogJ0ZGRkZGRicgfSB9XHJcbiAgICB9O1xyXG4gIH0pO1xyXG5cclxuICAvLyBEZWZpbmlyIGxhcmd1cmFzIGRhcyBjb2x1bmFzXHJcbiAgc3VtbWFyeVNoZWV0LmdldENvbHVtbigxKS53aWR0aCA9IDE1OyAvLyBEYXRhXHJcbiAgc3VtbWFyeVNoZWV0LmdldENvbHVtbigyKS53aWR0aCA9IDYwOyAvLyBUcmFuc2FjaW9uYWRvciAgXHJcbiAgc3VtbWFyeVNoZWV0LmdldENvbHVtbigzKS53aWR0aCA9IDIwOyAvLyBEb2N1bWVudG9cclxuICBzdW1tYXJ5U2hlZXQuZ2V0Q29sdW1uKDQpLndpZHRoID0gMTg7IC8vIFZhbG9yXHJcbn1cclxuXHJcbi8vIEZ1bsOnw6NvIHBhcmEgY3JpYXIgYWJhIGluZGl2aWR1YWwgZGEgZmlsaWFsIGF2YW7Dp2FkYVxyXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVBZHZhbmNlZEJyYW5jaFdvcmtzaGVldChcclxuICB3b3JrYm9vazogRXhjZWxKUy5Xb3JrYm9vaywgXHJcbiAgYnJhbmNoOiBCcmFuY2hEYXRhLCBcclxuICBicmFuY2hJbnZvaWNlczogSW52b2ljZURhdGFbXVxyXG4pIHtcclxuICBsZXQgY2xlYW5CcmFuY2hOYW1lID0gYnJhbmNoLm5hbWUucmVwbGFjZSgvW1xcL1xcXFxcXD9cXCpcXFtcXF1dL2csICdfJykuc3Vic3RyaW5nKDAsIDI1KTtcclxuICBjb25zdCB3b3Jrc2hlZXQgPSB3b3JrYm9vay5hZGRXb3Jrc2hlZXQoY2xlYW5CcmFuY2hOYW1lKTtcclxuICBsZXQgY3VycmVudFJvdyA9IDE7XHJcblxyXG4gIC8vIFTDrXR1bG8gZGEgZmlsaWFsXHJcbiAgY29uc3QgdGl0bGVSb3cgPSB3b3Jrc2hlZXQuYWRkUm93KFtgREVUQUxIQU1FTlRPIC0gJHticmFuY2gubmFtZX1gXSk7XHJcbiAgd29ya3NoZWV0Lm1lcmdlQ2VsbHMoYEEke2N1cnJlbnRSb3d9OkUke2N1cnJlbnRSb3d9YCk7XHJcbiAgdGl0bGVSb3cuZ2V0Q2VsbCgxKS5zdHlsZSA9IHRpdGxlU3R5bGU7XHJcbiAgdGl0bGVSb3cuaGVpZ2h0ID0gMzA7XHJcbiAgY3VycmVudFJvdysrO1xyXG5cclxuICAvLyBQZXLDrW9kb1xyXG4gIGlmIChicmFuY2hJbnZvaWNlcy5sZW5ndGggPiAwKSB7XHJcbiAgICBjb25zdCBicmFuY2hEYXRlcyA9IGJyYW5jaEludm9pY2VzLm1hcChpbnYgPT4gbmV3IERhdGUoaW52LmRhdGUpKS5zb3J0KChhLCBiKSA9PiBhLmdldFRpbWUoKSAtIGIuZ2V0VGltZSgpKTtcclxuICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IGJyYW5jaERhdGVzWzBdO1xyXG4gICAgY29uc3QgZW5kRGF0ZSA9IGJyYW5jaERhdGVzW2JyYW5jaERhdGVzLmxlbmd0aCAtIDFdO1xyXG4gICAgY29uc3QgcGVyaW9kVGV4dCA9IGBQRVLDjU9ETzogJHtzdGFydERhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCdwdC1CUicpfSAtICR7ZW5kRGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoJ3B0LUJSJyl9YDtcclxuICAgIFxyXG4gICAgd29ya3NoZWV0LmFkZFJvdyhbcGVyaW9kVGV4dF0pO1xyXG4gICAgd29ya3NoZWV0Lm1lcmdlQ2VsbHMoYEEke2N1cnJlbnRSb3d9OkUke2N1cnJlbnRSb3d9YCk7XHJcbiAgICB3b3Jrc2hlZXQuZ2V0Q2VsbChgQSR7Y3VycmVudFJvd31gKS5zdHlsZSA9IHtcclxuICAgICAgZm9udDogeyBib2xkOiB0cnVlLCBzaXplOiAxMiB9LFxyXG4gICAgICBmaWxsOiB7IHR5cGU6ICdwYXR0ZXJuJyBhcyBjb25zdCwgcGF0dGVybjogJ3NvbGlkJyBhcyBjb25zdCwgZmdDb2xvcjogeyBhcmdiOiAnRTdFNkU2JyB9IH0sXHJcbiAgICAgIGFsaWdubWVudDogeyBob3Jpem9udGFsOiAnY2VudGVyJyBhcyBjb25zdCwgdmVydGljYWw6ICdtaWRkbGUnIGFzIGNvbnN0IH1cclxuICAgIH07XHJcbiAgICBjdXJyZW50Um93Kys7XHJcbiAgfVxyXG5cclxuICAvLyBMaW5oYSB2YXppYVxyXG4gIHdvcmtzaGVldC5hZGRSb3coW10pO1xyXG4gIGN1cnJlbnRSb3crKztcclxuXHJcbiAgLy8gUmVzdW1vIGRhIGZpbGlhbFxyXG4gIGNvbnN0IHJlc3Vtb1JvdyA9IHdvcmtzaGVldC5hZGRSb3coWydSRVNVTU8gREEgRklMSUFMJ10pO1xyXG4gIHdvcmtzaGVldC5tZXJnZUNlbGxzKGBBJHtjdXJyZW50Um93fTpFJHtjdXJyZW50Um93fWApO1xyXG4gIHJlc3Vtb1Jvdy5nZXRDZWxsKDEpLnN0eWxlID0gc3ViSGVhZGVyU3R5bGU7XHJcbiAgcmVzdW1vUm93LmhlaWdodCA9IDI1O1xyXG4gIGN1cnJlbnRSb3crKztcclxuXHJcbiAgd29ya3NoZWV0LmFkZFJvdyhbJ1RvdGFsIEEgUGFnYXI6JywgYFIkICR7YnJhbmNoLnRvdGFsQVBhZ2FyLnRvTG9jYWxlU3RyaW5nKCdwdC1CUicsIHsgbWluaW11bUZyYWN0aW9uRGlnaXRzOiAyIH0pfWBdKTtcclxuICBjdXJyZW50Um93Kys7XHJcbiAgd29ya3NoZWV0LmFkZFJvdyhbJ1RvdGFsIEEgUmVjZWJlcjonLCBgUiQgJHticmFuY2gudG90YWxBUmVjZWJlci50b0xvY2FsZVN0cmluZygncHQtQlInLCB7IG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMiB9KX1gXSk7XHJcbiAgY3VycmVudFJvdysrO1xyXG5cclxuICBjb25zdCBzYWxkb0xpcXVpZG8gPSBicmFuY2gudG90YWxBUmVjZWJlciAtIGJyYW5jaC50b3RhbEFQYWdhcjtcclxuICBjb25zdCBzYWxkb1JvdyA9IHdvcmtzaGVldC5hZGRSb3coWydTYWxkbyBMw61xdWlkbzonLCBgUiQgJHtzYWxkb0xpcXVpZG8udG9Mb2NhbGVTdHJpbmcoJ3B0LUJSJywgeyBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDIgfSl9YF0pO1xyXG4gIFxyXG4gIC8vIENvbG9yaXIgc2FsZG8gbMOtcXVpZG9cclxuICBjb25zdCBzYWxkb0NlbGwgPSBzYWxkb1Jvdy5nZXRDZWxsKDIpO1xyXG4gIHNhbGRvQ2VsbC5mb250ID0geyBcclxuICAgIGJvbGQ6IHRydWUsIFxyXG4gICAgY29sb3I6IHsgYXJnYjogc2FsZG9MaXF1aWRvID4gMCA/ICcwMDgwMDAnIDogJ0ZGMDAwMCcgfVxyXG4gIH07XHJcbiAgY3VycmVudFJvdysrO1xyXG5cclxuICAvLyBMaW5oYSB2YXppYVxyXG4gIHdvcmtzaGVldC5hZGRSb3coW10pO1xyXG4gIGN1cnJlbnRSb3crKztcclxuICB3b3Jrc2hlZXQuYWRkUm93KFtdKTtcclxuICBjdXJyZW50Um93Kys7XHJcblxyXG4gIC8vIERldGFsaGFtZW50byBkZSB0cmFuc2HDp8O1ZXMgcG9yIHRpcG9cclxuICBpZiAoYnJhbmNoSW52b2ljZXMubGVuZ3RoID4gMCkge1xyXG4gICAgLy8gU2VwYXJhciBwb3IgdGlwbyBkZSBkb2N1bWVudG9cclxuICAgIGNvbnN0IGFwYWdhckludm9pY2VzID0gYnJhbmNoSW52b2ljZXMuZmlsdGVyKGludiA9PiBpbnYuZG9jdW1lbnRUeXBlID09PSAnQV9QQUdBUicpO1xyXG4gICAgY29uc3QgYXJlY2ViZXJJbnZvaWNlcyA9IGJyYW5jaEludm9pY2VzLmZpbHRlcihpbnYgPT4gaW52LmRvY3VtZW50VHlwZSA9PT0gJ0FfUkVDRUJFUicpO1xyXG5cclxuICAgIC8vIFByb2Nlc3NhciBBX1BBR0FSXHJcbiAgICBpZiAoYXBhZ2FySW52b2ljZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjb25zdCBhUGFnYXJIZWFkZXJSb3cgPSB3b3Jrc2hlZXQuYWRkUm93KFsnQ09OVEFTIEEgUEFHQVInXSk7XHJcbiAgICAgIHdvcmtzaGVldC5tZXJnZUNlbGxzKGBBJHtjdXJyZW50Um93fTpFJHtjdXJyZW50Um93fWApO1xyXG4gICAgICBhUGFnYXJIZWFkZXJSb3cuZ2V0Q2VsbCgxKS5zdHlsZSA9IHN1YkhlYWRlclN0eWxlO1xyXG4gICAgICBjdXJyZW50Um93Kys7XHJcblxyXG4gICAgICB3b3Jrc2hlZXQuYWRkUm93KFtdKTtcclxuICAgICAgY3VycmVudFJvdysrO1xyXG5cclxuICAgICAgLy8gQ2FiZcOnYWxob3MgZGFzIHRyYW5zYcOnw7VlcyBBX1BBR0FSXHJcbiAgICAgIGNvbnN0IHRyYW5zSGVhZGVyUm93ID0gd29ya3NoZWV0LmFkZFJvdyhbJ1ZlbmNpbWVudG8nLCAnVHJhbnNhY2lvbmFkb3InLCAnRG9jdW1lbnRvJywgJ1ZhbG9yJywgJ1N0YXR1cyddKTtcclxuICAgICAgdHJhbnNIZWFkZXJSb3cuZWFjaENlbGwoKGNlbGwpID0+IHtcclxuICAgICAgICBjZWxsLnN0eWxlID0gaGVhZGVyU3R5bGU7XHJcbiAgICAgIH0pO1xyXG4gICAgICBjdXJyZW50Um93Kys7XHJcblxyXG4gICAgICAvLyBPcmRlbmFyIHBvciBkYXRhIGUgYWRpY2lvbmFyIHRyYW5zYcOnw7Vlc1xyXG4gICAgICBhcGFnYXJJbnZvaWNlcy5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShhLmRhdGUpLmdldFRpbWUoKSAtIG5ldyBEYXRlKGIuZGF0ZSkuZ2V0VGltZSgpKTtcclxuICAgICAgXHJcbiAgICAgIGxldCBjdXJyZW50RGF0ZSA9ICcnO1xyXG4gICAgICBsZXQgZGFpbHlUb3RhbCA9IDA7XHJcblxyXG4gICAgICBhcGFnYXJJbnZvaWNlcy5mb3JFYWNoKGludm9pY2UgPT4ge1xyXG4gICAgICAgIGNvbnN0IGludm9pY2VEYXRlID0gbmV3IERhdGUoaW52b2ljZS5kYXRlKS50b0xvY2FsZURhdGVTdHJpbmcoJ3B0LUJSJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVmVyaWZpY2FyIG11ZGFuw6dhIGRlIGRhdGEgcGFyYSB0b3RhbCBkacOhcmlvXHJcbiAgICAgICAgaWYgKGN1cnJlbnREYXRlICYmIGN1cnJlbnREYXRlICE9PSBpbnZvaWNlRGF0ZSAmJiBkYWlseVRvdGFsID4gMCkge1xyXG4gICAgICAgICAgd29ya3NoZWV0LmFkZFJvdyhbJycsICcnLCAnVE9UQUwgREnDgVJJTycsIGRhaWx5VG90YWwsICcnXSk7XHJcbiAgICAgICAgICBjb25zdCB0b3RhbFJvdyA9IHdvcmtzaGVldC5nZXRSb3coY3VycmVudFJvdyk7XHJcbiAgICAgICAgICB0b3RhbFJvdy5lYWNoQ2VsbCgoY2VsbCwgY29sTnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICAgIGNlbGwuc3R5bGUgPSB7XHJcbiAgICAgICAgICAgICAgZm9udDogeyBib2xkOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgZmlsbDogeyB0eXBlOiAncGF0dGVybicgYXMgY29uc3QsIHBhdHRlcm46ICdzb2xpZCcgYXMgY29uc3QsIGZnQ29sb3I6IHsgYXJnYjogJ0YyRjJGMicgfSB9LFxyXG4gICAgICAgICAgICAgIG51bUZtdDogY29sTnVtYmVyID09PSA0ID8gJ1IkICMsIyMwLjAwJyA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICBib3JkZXI6IGNlbGxTdHlsZS5ib3JkZXJcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgY3VycmVudFJvdysrO1xyXG4gICAgICAgICAgZGFpbHlUb3RhbCA9IDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB3b3Jrc2hlZXQuYWRkUm93KFtcclxuICAgICAgICAgIGludm9pY2VEYXRlLFxyXG4gICAgICAgICAgaW52b2ljZS5zdXBwbGllcixcclxuICAgICAgICAgIGludm9pY2UuaW52b2ljZU51bWJlcixcclxuICAgICAgICAgIGludm9pY2UudmFsdWVOdW1lcmljLFxyXG4gICAgICAgICAgJ1BlbmRlbnRlJ1xyXG4gICAgICAgIF0pO1xyXG5cclxuICAgICAgICBjb25zdCByb3cgPSB3b3Jrc2hlZXQuZ2V0Um93KGN1cnJlbnRSb3cpO1xyXG4gICAgICAgIHJvdy5lYWNoQ2VsbCgoY2VsbCwgY29sTnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICBjZWxsLnN0eWxlID0gY2VsbFN0eWxlO1xyXG4gICAgICAgICAgaWYgKGNvbE51bWJlciA9PT0gNCkge1xyXG4gICAgICAgICAgICBjZWxsLm51bUZtdCA9ICdSJCAjLCMjMC4wMCc7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGN1cnJlbnREYXRlID0gaW52b2ljZURhdGU7XHJcbiAgICAgICAgZGFpbHlUb3RhbCArPSBpbnZvaWNlLnZhbHVlTnVtZXJpYztcclxuICAgICAgICBjdXJyZW50Um93Kys7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gVG90YWwgZmluYWwgQV9QQUdBUlxyXG4gICAgICBpZiAoZGFpbHlUb3RhbCA+IDApIHtcclxuICAgICAgICB3b3Jrc2hlZXQuYWRkUm93KFsnJywgJycsICdUT1RBTCBEScOBUklPJywgZGFpbHlUb3RhbCwgJyddKTtcclxuICAgICAgICBjb25zdCB0b3RhbFJvdyA9IHdvcmtzaGVldC5nZXRSb3coY3VycmVudFJvdyk7XHJcbiAgICAgICAgdG90YWxSb3cuZWFjaENlbGwoKGNlbGwsIGNvbE51bWJlcikgPT4ge1xyXG4gICAgICAgICAgY2VsbC5zdHlsZSA9IHtcclxuICAgICAgICAgICAgZm9udDogeyBib2xkOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIGZpbGw6IHsgdHlwZTogJ3BhdHRlcm4nIGFzIGNvbnN0LCBwYXR0ZXJuOiAnc29saWQnIGFzIGNvbnN0LCBmZ0NvbG9yOiB7IGFyZ2I6ICdGMkYyRjInIH0gfSxcclxuICAgICAgICAgICAgbnVtRm10OiBjb2xOdW1iZXIgPT09IDQgPyAnUiQgIywjIzAuMDAnIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICBib3JkZXI6IGNlbGxTdHlsZS5ib3JkZXJcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY3VycmVudFJvdysrO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCB0b3RhbEFQYWdhclJvdyA9IHdvcmtzaGVldC5hZGRSb3coWycnLCAnJywgJ1RPVEFMIEEgUEFHQVInLCBicmFuY2gudG90YWxBUGFnYXIsICcnXSk7XHJcbiAgICAgIHRvdGFsQVBhZ2FyUm93LmVhY2hDZWxsKChjZWxsLCBjb2xOdW1iZXIpID0+IHtcclxuICAgICAgICBjZWxsLnN0eWxlID0ge1xyXG4gICAgICAgICAgLi4udG90YWxSb3dTdHlsZSxcclxuICAgICAgICAgIG51bUZtdDogY29sTnVtYmVyID09PSA0ID8gJ1IkICMsIyMwLjAwJyA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgIGJvcmRlcjogY2VsbFN0eWxlLmJvcmRlclxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pO1xyXG4gICAgICBjdXJyZW50Um93Kys7XHJcblxyXG4gICAgICAvLyBMaW5oYSB2YXppYVxyXG4gICAgICB3b3Jrc2hlZXQuYWRkUm93KFtdKTtcclxuICAgICAgY3VycmVudFJvdysrO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFByb2Nlc3NhciBBX1JFQ0VCRVJcclxuICAgIGlmIChhcmVjZWJlckludm9pY2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc3QgYVJlY2ViZXJIZWFkZXJSb3cgPSB3b3Jrc2hlZXQuYWRkUm93KFsnQ09OVEFTIEEgUkVDRUJFUiddKTtcclxuICAgICAgd29ya3NoZWV0Lm1lcmdlQ2VsbHMoYEEke2N1cnJlbnRSb3d9OkUke2N1cnJlbnRSb3d9YCk7XHJcbiAgICAgIGFSZWNlYmVySGVhZGVyUm93LmdldENlbGwoMSkuc3R5bGUgPSBzdWJIZWFkZXJTdHlsZTtcclxuICAgICAgY3VycmVudFJvdysrO1xyXG5cclxuICAgICAgd29ya3NoZWV0LmFkZFJvdyhbXSk7XHJcbiAgICAgIGN1cnJlbnRSb3crKztcclxuXHJcbiAgICAgIC8vIENhYmXDp2FsaG9zIGRhcyB0cmFuc2HDp8O1ZXMgQV9SRUNFQkVSXHJcbiAgICAgIGNvbnN0IHRyYW5zSGVhZGVyUm93ID0gd29ya3NoZWV0LmFkZFJvdyhbJ1ZlbmNpbWVudG8nLCAnQ2xpZW50ZScsICdEb2N1bWVudG8nLCAnVmFsb3InLCAnU3RhdHVzJ10pO1xyXG4gICAgICB0cmFuc0hlYWRlclJvdy5lYWNoQ2VsbCgoY2VsbCkgPT4ge1xyXG4gICAgICAgIGNlbGwuc3R5bGUgPSBoZWFkZXJTdHlsZTtcclxuICAgICAgfSk7XHJcbiAgICAgIGN1cnJlbnRSb3crKztcclxuXHJcbiAgICAgIC8vIE9yZGVuYXIgcG9yIGRhdGEgZSBhZGljaW9uYXIgdHJhbnNhw6fDtWVzXHJcbiAgICAgIGFyZWNlYmVySW52b2ljZXMuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYS5kYXRlKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShiLmRhdGUpLmdldFRpbWUoKSk7XHJcbiAgICAgIFxyXG4gICAgICBsZXQgY3VycmVudERhdGUgPSAnJztcclxuICAgICAgbGV0IGRhaWx5VG90YWwgPSAwO1xyXG5cclxuICAgICAgYXJlY2ViZXJJbnZvaWNlcy5mb3JFYWNoKGludm9pY2UgPT4ge1xyXG4gICAgICAgIGNvbnN0IGludm9pY2VEYXRlID0gbmV3IERhdGUoaW52b2ljZS5kYXRlKS50b0xvY2FsZURhdGVTdHJpbmcoJ3B0LUJSJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVmVyaWZpY2FyIG11ZGFuw6dhIGRlIGRhdGEgcGFyYSB0b3RhbCBkacOhcmlvXHJcbiAgICAgICAgaWYgKGN1cnJlbnREYXRlICYmIGN1cnJlbnREYXRlICE9PSBpbnZvaWNlRGF0ZSAmJiBkYWlseVRvdGFsID4gMCkge1xyXG4gICAgICAgICAgd29ya3NoZWV0LmFkZFJvdyhbJycsICcnLCAnVE9UQUwgREnDgVJJTycsIGRhaWx5VG90YWwsICcnXSk7XHJcbiAgICAgICAgICBjb25zdCB0b3RhbFJvdyA9IHdvcmtzaGVldC5nZXRSb3coY3VycmVudFJvdyk7XHJcbiAgICAgICAgICB0b3RhbFJvdy5lYWNoQ2VsbCgoY2VsbCwgY29sTnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICAgIGNlbGwuc3R5bGUgPSB7XHJcbiAgICAgICAgICAgICAgZm9udDogeyBib2xkOiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgZmlsbDogeyB0eXBlOiAncGF0dGVybicgYXMgY29uc3QsIHBhdHRlcm46ICdzb2xpZCcgYXMgY29uc3QsIGZnQ29sb3I6IHsgYXJnYjogJ0YyRjJGMicgfSB9LFxyXG4gICAgICAgICAgICAgIG51bUZtdDogY29sTnVtYmVyID09PSA0ID8gJ1IkICMsIyMwLjAwJyA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICBib3JkZXI6IGNlbGxTdHlsZS5ib3JkZXJcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgY3VycmVudFJvdysrO1xyXG4gICAgICAgICAgZGFpbHlUb3RhbCA9IDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB3b3Jrc2hlZXQuYWRkUm93KFtcclxuICAgICAgICAgIGludm9pY2VEYXRlLFxyXG4gICAgICAgICAgaW52b2ljZS5zdXBwbGllcixcclxuICAgICAgICAgIGludm9pY2UuaW52b2ljZU51bWJlcixcclxuICAgICAgICAgIGludm9pY2UudmFsdWVOdW1lcmljLFxyXG4gICAgICAgICAgJ1BlbmRlbnRlJ1xyXG4gICAgICAgIF0pO1xyXG5cclxuICAgICAgICBjb25zdCByb3cgPSB3b3Jrc2hlZXQuZ2V0Um93KGN1cnJlbnRSb3cpO1xyXG4gICAgICAgIHJvdy5lYWNoQ2VsbCgoY2VsbCwgY29sTnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICBjZWxsLnN0eWxlID0gY2VsbFN0eWxlO1xyXG4gICAgICAgICAgaWYgKGNvbE51bWJlciA9PT0gNCkge1xyXG4gICAgICAgICAgICBjZWxsLm51bUZtdCA9ICdSJCAjLCMjMC4wMCc7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGN1cnJlbnREYXRlID0gaW52b2ljZURhdGU7XHJcbiAgICAgICAgZGFpbHlUb3RhbCArPSBpbnZvaWNlLnZhbHVlTnVtZXJpYztcclxuICAgICAgICBjdXJyZW50Um93Kys7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gVG90YWwgZmluYWwgQV9SRUNFQkVSXHJcbiAgICAgIGlmIChkYWlseVRvdGFsID4gMCkge1xyXG4gICAgICAgIHdvcmtzaGVldC5hZGRSb3coWycnLCAnJywgJ1RPVEFMIERJw4FSSU8nLCBkYWlseVRvdGFsLCAnJ10pO1xyXG4gICAgICAgIGNvbnN0IHRvdGFsUm93ID0gd29ya3NoZWV0LmdldFJvdyhjdXJyZW50Um93KTtcclxuICAgICAgICB0b3RhbFJvdy5lYWNoQ2VsbCgoY2VsbCwgY29sTnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICBjZWxsLnN0eWxlID0ge1xyXG4gICAgICAgICAgICBmb250OiB7IGJvbGQ6IHRydWUgfSxcclxuICAgICAgICAgICAgZmlsbDogeyB0eXBlOiAncGF0dGVybicgYXMgY29uc3QsIHBhdHRlcm46ICdzb2xpZCcgYXMgY29uc3QsIGZnQ29sb3I6IHsgYXJnYjogJ0YyRjJGMicgfSB9LFxyXG4gICAgICAgICAgICBudW1GbXQ6IGNvbE51bWJlciA9PT0gNCA/ICdSJCAjLCMjMC4wMCcgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIGJvcmRlcjogY2VsbFN0eWxlLmJvcmRlclxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjdXJyZW50Um93Kys7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHRvdGFsQVJlY2ViZXJSb3cgPSB3b3Jrc2hlZXQuYWRkUm93KFsnJywgJycsICdUT1RBTCBBIFJFQ0VCRVInLCBicmFuY2gudG90YWxBUmVjZWJlciwgJyddKTtcclxuICAgICAgdG90YWxBUmVjZWJlclJvdy5lYWNoQ2VsbCgoY2VsbCwgY29sTnVtYmVyKSA9PiB7XHJcbiAgICAgICAgY2VsbC5zdHlsZSA9IHtcclxuICAgICAgICAgIC4uLnRvdGFsUm93U3R5bGUsXHJcbiAgICAgICAgICBudW1GbXQ6IGNvbE51bWJlciA9PT0gNCA/ICdSJCAjLCMjMC4wMCcgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBib3JkZXI6IGNlbGxTdHlsZS5ib3JkZXJcclxuICAgICAgICB9O1xyXG4gICAgICB9KTtcclxuICAgICAgY3VycmVudFJvdysrO1xyXG4gICAgfVxyXG5cclxuICB9IGVsc2Uge1xyXG4gICAgLy8gTWVuc2FnZW0gcXVhbmRvIG7Do28gaMOhIHRyYW5zYcOnw7VlcyBkZXRhbGhhZGFzXHJcbiAgICBjb25zdCBub0RhdGFSb3cgPSB3b3Jrc2hlZXQuYWRkUm93KFsnVFJBTlNBw4fDlUVTIERFVEFMSEFEQVMnXSk7XHJcbiAgICB3b3Jrc2hlZXQubWVyZ2VDZWxscyhgQSR7Y3VycmVudFJvd306RSR7Y3VycmVudFJvd31gKTtcclxuICAgIG5vRGF0YVJvdy5nZXRDZWxsKDEpLnN0eWxlID0gc3ViSGVhZGVyU3R5bGU7XHJcbiAgICBjdXJyZW50Um93Kys7XHJcblxyXG4gICAgd29ya3NoZWV0LmFkZFJvdyhbXSk7XHJcbiAgICBjdXJyZW50Um93Kys7XHJcbiAgICB3b3Jrc2hlZXQuYWRkUm93KFsnRGFkb3MgZGV0YWxoYWRvcyBkYXMgdHJhbnNhw6fDtWVzIHNlcsOjbyBleGliaWRvcyBhcXVpIHF1YW5kbyBkaXNwb27DrXZlaXMuJ10pO1xyXG4gICAgd29ya3NoZWV0LmFkZFJvdyhbJ1BhcmEgb2J0ZXIgZGV0YWxoZXMsIGZhw6dhIHVwbG9hZCBkb3MgYXJxdWl2b3MgQ1NWIGluZGl2aWR1YWlzLiddKTtcclxuICB9XHJcblxyXG4gIC8vIEFqdXN0YXIgbGFyZ3VyYSBkYXMgY29sdW5hc1xyXG4gIHdvcmtzaGVldC5jb2x1bW5zID0gW1xyXG4gICAgeyB3aWR0aDogMTUgfSwgLy8gVmVuY2ltZW50b1xyXG4gICAgeyB3aWR0aDogNDAgfSwgLy8gVHJhbnNhY2lvbmFkb3IvQ2xpZW50ZVxyXG4gICAgeyB3aWR0aDogMjAgfSwgLy8gRG9jdW1lbnRvXHJcbiAgICB7IHdpZHRoOiAxOCB9LCAvLyBWYWxvclxyXG4gICAgeyB3aWR0aDogMTIgfSAgLy8gU3RhdHVzXHJcbiAgXTtcclxufVxyXG5cclxuLy8gRnVuw6fDo28gcGFyYSBjcmlhciBhIGFiYSBkZSByZXN1bW8gZ2VyYWxcclxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlUmVzdW1vR2VyYWxXb3Jrc2hlZXQod29ya2Jvb2s6IEV4Y2VsSlMuV29ya2Jvb2ssIHN1bW1hcnlEYXRhOiBTdW1tYXJ5RGF0YSkge1xyXG4gIGNvbnN0IHdvcmtzaGVldCA9IHdvcmtib29rLmFkZFdvcmtzaGVldCgnUmVzdW1vIEdlcmFsJyk7XHJcbiAgXHJcbiAgLy8gVMOtdHVsbyBwcmluY2lwYWxcclxuICBjb25zdCB0aXRsZVJvdyA9IHdvcmtzaGVldC5hZGRSb3coWydSRVNVTU8gR0VSQUwgLSBTQUxETyBMw41RVUlETyBQT1IgRklMSUFMJ10pO1xyXG4gIHdvcmtzaGVldC5tZXJnZUNlbGxzKCdBMTpEMScpO1xyXG4gIHRpdGxlUm93LmdldENlbGwoMSkuZmlsbCA9IHsgdHlwZTogJ3BhdHRlcm4nLCBwYXR0ZXJuOiAnc29saWQnLCBmZ0NvbG9yOiB7IGFyZ2I6ICdGRjQ0NzJDNCcgfSB9O1xyXG4gIHRpdGxlUm93LmdldENlbGwoMSkuZm9udCA9IHsgYm9sZDogdHJ1ZSwgY29sb3I6IHsgYXJnYjogJ0ZGRkZGRkZGJyB9LCBzaXplOiAxNiB9O1xyXG4gIHRpdGxlUm93LmdldENlbGwoMSkuYWxpZ25tZW50ID0geyBob3Jpem9udGFsOiAnY2VudGVyJywgdmVydGljYWw6ICdtaWRkbGUnIH07XHJcbiAgdGl0bGVSb3cuaGVpZ2h0ID0gMzA7XHJcbiAgXHJcbiAgd29ya3NoZWV0LmFkZFJvdyhbXSk7IC8vIExpbmhhIHZhemlhXHJcbiAgXHJcbiAgLy8gQ2FiZcOnYWxob3NcclxuICBjb25zdCBoZWFkZXJSb3cgPSB3b3Jrc2hlZXQuYWRkUm93KFsnRklMSUFMJywgJ1RPVEFMIEEgUEFHQVInLCAnVE9UQUwgQSBSRUNFQkVSJywgJ1NBTERPIEzDjVFVSURPJ10pO1xyXG4gIGhlYWRlclJvdy5mb250ID0geyBib2xkOiB0cnVlLCBjb2xvcjogeyBhcmdiOiAnRkZGRkZGRkYnIH0gfTtcclxuICBoZWFkZXJSb3cuZmlsbCA9IHsgdHlwZTogJ3BhdHRlcm4nLCBwYXR0ZXJuOiAnc29saWQnLCBmZ0NvbG9yOiB7IGFyZ2I6ICdGRjQ0NzJDNCcgfSB9O1xyXG4gIGhlYWRlclJvdy5hbGlnbm1lbnQgPSB7IGhvcml6b250YWw6ICdjZW50ZXInLCB2ZXJ0aWNhbDogJ21pZGRsZScgfTtcclxuICBcclxuICAvLyBEYWRvcyBkYXMgZmlsaWFpc1xyXG4gIHN1bW1hcnlEYXRhLmJyYW5jaGVzLmZvckVhY2goYnJhbmNoID0+IHtcclxuICAgIGNvbnN0IHNhbGRvTGlxdWlkbyA9IGJyYW5jaC50b3RhbEFSZWNlYmVyIC0gYnJhbmNoLnRvdGFsQVBhZ2FyO1xyXG4gICAgY29uc3Qgcm93ID0gd29ya3NoZWV0LmFkZFJvdyhbXHJcbiAgICAgIGJyYW5jaC5uYW1lLFxyXG4gICAgICBgUiQgJHticmFuY2gudG90YWxBUGFnYXIudG9Mb2NhbGVTdHJpbmcoJ3B0LUJSJywgeyBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDIgfSl9YCxcclxuICAgICAgYFIkICR7YnJhbmNoLnRvdGFsQVJlY2ViZXIudG9Mb2NhbGVTdHJpbmcoJ3B0LUJSJywgeyBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDIgfSl9YCxcclxuICAgICAgYFIkICR7c2FsZG9MaXF1aWRvLnRvTG9jYWxlU3RyaW5nKCdwdC1CUicsIHsgbWluaW11bUZyYWN0aW9uRGlnaXRzOiAyIH0pfWBcclxuICAgIF0pO1xyXG4gICAgXHJcbiAgICAvLyBDb2xvcmlyIHNhbGRvIGzDrXF1aWRvIGNvbmZvcm1lIHZhbG9yXHJcbiAgICBjb25zdCBzYWxkb0NlbGwgPSByb3cuZ2V0Q2VsbCg0KTtcclxuICAgIGlmIChzYWxkb0xpcXVpZG8gPiAwKSB7XHJcbiAgICAgIHNhbGRvQ2VsbC5mb250ID0geyBjb2xvcjogeyBhcmdiOiAnRkYwMDgwMDAnIH0sIGJvbGQ6IHRydWUgfTsgLy8gVmVyZGVcclxuICAgIH0gZWxzZSBpZiAoc2FsZG9MaXF1aWRvIDwgMCkge1xyXG4gICAgICBzYWxkb0NlbGwuZm9udCA9IHsgY29sb3I6IHsgYXJnYjogJ0ZGRkYwMDAwJyB9LCBib2xkOiB0cnVlIH07IC8vIFZlcm1lbGhvXHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgXHJcbiAgLy8gTGluaGEgZGUgdG90YWwgZ2VyYWxcclxuICB3b3Jrc2hlZXQuYWRkUm93KFtdKTsgLy8gTGluaGEgdmF6aWFcclxuICBjb25zdCB0b3RhbFJvdyA9IHdvcmtzaGVldC5hZGRSb3coW1xyXG4gICAgJ1RPVEFMIEdFUkFMJyxcclxuICAgIGBSJCAke3N1bW1hcnlEYXRhLmdyYW5kVG90YWxBUGFnYXIudG9Mb2NhbGVTdHJpbmcoJ3B0LUJSJywgeyBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDIgfSl9YCxcclxuICAgIGBSJCAke3N1bW1hcnlEYXRhLmdyYW5kVG90YWxBUmVjZWJlci50b0xvY2FsZVN0cmluZygncHQtQlInLCB7IG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMiB9KX1gLFxyXG4gICAgYFIkICR7KHN1bW1hcnlEYXRhLmdyYW5kVG90YWxBUmVjZWJlciAtIHN1bW1hcnlEYXRhLmdyYW5kVG90YWxBUGFnYXIpLnRvTG9jYWxlU3RyaW5nKCdwdC1CUicsIHsgbWluaW11bUZyYWN0aW9uRGlnaXRzOiAyIH0pfWBcclxuICBdKTtcclxuICBcclxuICB0b3RhbFJvdy5mb250ID0geyBib2xkOiB0cnVlLCBzaXplOiAxMiB9O1xyXG4gIHRvdGFsUm93LmZpbGwgPSB7IHR5cGU6ICdwYXR0ZXJuJywgcGF0dGVybjogJ3NvbGlkJywgZmdDb2xvcjogeyBhcmdiOiAnRkZFMEUwRTAnIH0gfTtcclxuICBcclxuICAvLyBBanVzdGFyIGxhcmd1cmEgZGFzIGNvbHVuYXNcclxuICB3b3Jrc2hlZXQuY29sdW1ucyA9IFtcclxuICAgIHsgd2lkdGg6IDIwIH0sIC8vIEZpbGlhbFxyXG4gICAgeyB3aWR0aDogMTggfSwgLy8gVG90YWwgQSBQYWdhclxyXG4gICAgeyB3aWR0aDogMTggfSwgLy8gVG90YWwgQSBSZWNlYmVyXHJcbiAgICB7IHdpZHRoOiAxOCB9ICAvLyBTYWxkbyBMw61xdWlkb1xyXG4gIF07XHJcbiAgXHJcbiAgLy8gQWRpY2lvbmFyIGJvcmRhc1xyXG4gIGNvbnN0IGRhdGFSYW5nZSA9IHdvcmtzaGVldC5nZXRSb3dzKDMsIHdvcmtzaGVldC5yb3dDb3VudCAtIDIpO1xyXG4gIGRhdGFSYW5nZT8uZm9yRWFjaChyb3cgPT4ge1xyXG4gICAgcm93LmVhY2hDZWxsKGNlbGwgPT4ge1xyXG4gICAgICBjZWxsLmJvcmRlciA9IHtcclxuICAgICAgICB0b3A6IHsgc3R5bGU6ICd0aGluJyB9LFxyXG4gICAgICAgIGxlZnQ6IHsgc3R5bGU6ICd0aGluJyB9LFxyXG4gICAgICAgIGJvdHRvbTogeyBzdHlsZTogJ3RoaW4nIH0sXHJcbiAgICAgICAgcmlnaHQ6IHsgc3R5bGU6ICd0aGluJyB9XHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuLy8gRnVuw6fDo28gcGFyYSBjcmlhciBhYmEgaW5kaXZpZHVhbCBkYSBmaWxpYWxcclxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlQnJhbmNoV29ya3NoZWV0KHdvcmtib29rOiBFeGNlbEpTLldvcmtib29rLCBicmFuY2g6IEJyYW5jaERhdGEsIHByb2Nlc3NlZERhdGE/OiBQcm9jZXNzZWREYXRhKSB7XHJcbiAgY29uc3Qgd29ya3NoZWV0ID0gd29ya2Jvb2suYWRkV29ya3NoZWV0KGJyYW5jaC5uYW1lKTtcclxuICBcclxuICAvLyBUw610dWxvIGRhIGZpbGlhbFxyXG4gIGNvbnN0IHRpdGxlUm93ID0gd29ya3NoZWV0LmFkZFJvdyhbYERFVEFMSEFNRU5UTyAtICR7YnJhbmNoLm5hbWV9YF0pO1xyXG4gIHdvcmtzaGVldC5tZXJnZUNlbGxzKCdBMTpFMScpO1xyXG4gIHRpdGxlUm93LmdldENlbGwoMSkuZmlsbCA9IHsgdHlwZTogJ3BhdHRlcm4nLCBwYXR0ZXJuOiAnc29saWQnLCBmZ0NvbG9yOiB7IGFyZ2I6ICdGRjQ0NzJDNCcgfSB9O1xyXG4gIHRpdGxlUm93LmdldENlbGwoMSkuZm9udCA9IHsgYm9sZDogdHJ1ZSwgY29sb3I6IHsgYXJnYjogJ0ZGRkZGRkZGJyB9LCBzaXplOiAxNCB9O1xyXG4gIHRpdGxlUm93LmdldENlbGwoMSkuYWxpZ25tZW50ID0geyBob3Jpem9udGFsOiAnY2VudGVyJywgdmVydGljYWw6ICdtaWRkbGUnIH07XHJcbiAgdGl0bGVSb3cuaGVpZ2h0ID0gMjU7XHJcbiAgXHJcbiAgd29ya3NoZWV0LmFkZFJvdyhbXSk7IC8vIExpbmhhIHZhemlhXHJcbiAgXHJcbiAgLy8gUmVzdW1vIGRhIGZpbGlhbFxyXG4gIGNvbnN0IHJlc3Vtb1JvdyA9IHdvcmtzaGVldC5hZGRSb3coWydSRVNVTU8gREEgRklMSUFMJ10pO1xyXG4gIHdvcmtzaGVldC5tZXJnZUNlbGxzKCdBMzpFMycpO1xyXG4gIHJlc3Vtb1Jvdy5nZXRDZWxsKDEpLmZvbnQgPSB7IGJvbGQ6IHRydWUsIHNpemU6IDEyIH07XHJcbiAgcmVzdW1vUm93LmdldENlbGwoMSkuZmlsbCA9IHsgdHlwZTogJ3BhdHRlcm4nLCBwYXR0ZXJuOiAnc29saWQnLCBmZ0NvbG9yOiB7IGFyZ2I6ICdGRkUwRTBFMCcgfSB9O1xyXG4gIHJlc3Vtb1Jvdy5nZXRDZWxsKDEpLmFsaWdubWVudCA9IHsgaG9yaXpvbnRhbDogJ2NlbnRlcicgfTtcclxuICBcclxuICB3b3Jrc2hlZXQuYWRkUm93KFsnVG90YWwgQSBQYWdhcjonLCBgUiQgJHticmFuY2gudG90YWxBUGFnYXIudG9Mb2NhbGVTdHJpbmcoJ3B0LUJSJywgeyBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDIgfSl9YF0pO1xyXG4gIHdvcmtzaGVldC5hZGRSb3coWydUb3RhbCBBIFJlY2ViZXI6JywgYFIkICR7YnJhbmNoLnRvdGFsQVJlY2ViZXIudG9Mb2NhbGVTdHJpbmcoJ3B0LUJSJywgeyBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDIgfSl9YF0pO1xyXG4gIFxyXG4gIGNvbnN0IHNhbGRvTGlxdWlkbyA9IGJyYW5jaC50b3RhbEFSZWNlYmVyIC0gYnJhbmNoLnRvdGFsQVBhZ2FyO1xyXG4gIGNvbnN0IHNhbGRvUm93ID0gd29ya3NoZWV0LmFkZFJvdyhbJ1NhbGRvIEzDrXF1aWRvOicsIGBSJCAke3NhbGRvTGlxdWlkby50b0xvY2FsZVN0cmluZygncHQtQlInLCB7IG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMiB9KX1gXSk7XHJcbiAgXHJcbiAgLy8gQ29sb3JpciBzYWxkbyBsw61xdWlkb1xyXG4gIGNvbnN0IHNhbGRvQ2VsbCA9IHNhbGRvUm93LmdldENlbGwoMik7XHJcbiAgaWYgKHNhbGRvTGlxdWlkbyA+IDApIHtcclxuICAgIHNhbGRvQ2VsbC5mb250ID0geyBjb2xvcjogeyBhcmdiOiAnRkYwMDgwMDAnIH0sIGJvbGQ6IHRydWUgfTsgLy8gVmVyZGVcclxuICB9IGVsc2UgaWYgKHNhbGRvTGlxdWlkbyA8IDApIHtcclxuICAgIHNhbGRvQ2VsbC5mb250ID0geyBjb2xvcjogeyBhcmdiOiAnRkZGRjAwMDAnIH0sIGJvbGQ6IHRydWUgfTsgLy8gVmVybWVsaG9cclxuICB9XHJcbiAgXHJcbiAgd29ya3NoZWV0LmFkZFJvdyhbXSk7IC8vIExpbmhhIHZhemlhXHJcbiAgd29ya3NoZWV0LmFkZFJvdyhbXSk7IC8vIExpbmhhIHZhemlhXHJcbiAgXHJcbiAgLy8gRGV0YWxoYW1lbnRvIGRlIHRyYW5zYcOnw7VlcyAoc2UgZGlzcG9uw612ZWwpXHJcbiAgaWYgKHByb2Nlc3NlZERhdGEgJiYgcHJvY2Vzc2VkRGF0YS50cmFuc2FjdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgY29uc3QgdHJhbnNhY3Rpb25zSGVhZGVyUm93ID0gd29ya3NoZWV0LmFkZFJvdyhbJ0RFVEFMSEFNRU5UTyBERSBUUkFOU0HDh8OVRVMnXSk7XHJcbiAgICB3b3Jrc2hlZXQubWVyZ2VDZWxscyhgQSR7d29ya3NoZWV0LnJvd0NvdW50fTpFJHt3b3Jrc2hlZXQucm93Q291bnR9YCk7XHJcbiAgICB0cmFuc2FjdGlvbnNIZWFkZXJSb3cuZ2V0Q2VsbCgxKS5mb250ID0geyBib2xkOiB0cnVlLCBzaXplOiAxMiB9O1xyXG4gICAgdHJhbnNhY3Rpb25zSGVhZGVyUm93LmdldENlbGwoMSkuZmlsbCA9IHsgdHlwZTogJ3BhdHRlcm4nLCBwYXR0ZXJuOiAnc29saWQnLCBmZ0NvbG9yOiB7IGFyZ2I6ICdGRkUwRTBFMCcgfSB9O1xyXG4gICAgdHJhbnNhY3Rpb25zSGVhZGVyUm93LmdldENlbGwoMSkuYWxpZ25tZW50ID0geyBob3Jpem9udGFsOiAnY2VudGVyJyB9O1xyXG4gICAgXHJcbiAgICB3b3Jrc2hlZXQuYWRkUm93KFtdKTsgLy8gTGluaGEgdmF6aWFcclxuICAgIFxyXG4gICAgLy8gQ2FiZcOnYWxob3MgZGFzIHRyYW5zYcOnw7Vlc1xyXG4gICAgY29uc3QgdHJhbnNIZWFkZXJSb3cgPSB3b3Jrc2hlZXQuYWRkUm93KFsnVmVuY2ltZW50bycsICdUcmFuc2FjaW9uYWRvcicsICdEb2N1bWVudG8nLCAnVmFsb3InLCAnVGlwbyddKTtcclxuICAgIHRyYW5zSGVhZGVyUm93LmZvbnQgPSB7IGJvbGQ6IHRydWUsIGNvbG9yOiB7IGFyZ2I6ICdGRkZGRkZGRicgfSB9O1xyXG4gICAgdHJhbnNIZWFkZXJSb3cuZmlsbCA9IHsgdHlwZTogJ3BhdHRlcm4nLCBwYXR0ZXJuOiAnc29saWQnLCBmZ0NvbG9yOiB7IGFyZ2I6ICdGRjQ0NzJDNCcgfSB9O1xyXG4gICAgXHJcbiAgICAvLyBEYWRvcyBkYXMgdHJhbnNhw6fDtWVzXHJcbiAgICBwcm9jZXNzZWREYXRhLnRyYW5zYWN0aW9ucy5mb3JFYWNoKHRyYW5zYWN0aW9uID0+IHtcclxuICAgICAgY29uc3QgdGlwbyA9IHRyYW5zYWN0aW9uLnZhbG9yTnVtZXJpY28gPiAwID8gJ0EgUGFnYXInIDogJ0EgUmVjZWJlcic7XHJcbiAgICAgIHdvcmtzaGVldC5hZGRSb3coW1xyXG4gICAgICAgIHRyYW5zYWN0aW9uLnZlbmNpbWVudG8sXHJcbiAgICAgICAgdHJhbnNhY3Rpb24udHJhbnNhY2lvbmFkb3IsXHJcbiAgICAgICAgdHJhbnNhY3Rpb24uZG9jdW1lbnRvLFxyXG4gICAgICAgIHRyYW5zYWN0aW9uLnZhbG9yLFxyXG4gICAgICAgIHRpcG9cclxuICAgICAgXSk7XHJcbiAgICB9KTtcclxuICB9IGVsc2Uge1xyXG4gICAgLy8gTWVuc2FnZW0gcXVhbmRvIG7Do28gaMOhIHRyYW5zYcOnw7VlcyBkZXRhbGhhZGFzXHJcbiAgICBjb25zdCBub0RhdGFSb3cgPSB3b3Jrc2hlZXQuYWRkUm93KFsnVFJBTlNBw4fDlUVTIERFVEFMSEFEQVMnXSk7XHJcbiAgICB3b3Jrc2hlZXQubWVyZ2VDZWxscyhgQSR7d29ya3NoZWV0LnJvd0NvdW50fTpFJHt3b3Jrc2hlZXQucm93Q291bnR9YCk7XHJcbiAgICBub0RhdGFSb3cuZ2V0Q2VsbCgxKS5mb250ID0geyBib2xkOiB0cnVlLCBzaXplOiAxMiB9O1xyXG4gICAgbm9EYXRhUm93LmdldENlbGwoMSkuZmlsbCA9IHsgdHlwZTogJ3BhdHRlcm4nLCBwYXR0ZXJuOiAnc29saWQnLCBmZ0NvbG9yOiB7IGFyZ2I6ICdGRkUwRTBFMCcgfSB9O1xyXG4gICAgbm9EYXRhUm93LmdldENlbGwoMSkuYWxpZ25tZW50ID0geyBob3Jpem9udGFsOiAnY2VudGVyJyB9O1xyXG4gICAgXHJcbiAgICB3b3Jrc2hlZXQuYWRkUm93KFtdKTsgLy8gTGluaGEgdmF6aWFcclxuICAgIHdvcmtzaGVldC5hZGRSb3coWydEYWRvcyBkZXRhbGhhZG9zIGRhcyB0cmFuc2HDp8O1ZXMgc2Vyw6NvIGV4aWJpZG9zIGFxdWkgcXVhbmRvIGRpc3BvbsOtdmVpcy4nXSk7XHJcbiAgICB3b3Jrc2hlZXQuYWRkUm93KFsnUGFyYSBvYnRlciBkZXRhbGhlcywgZmHDp2EgdXBsb2FkIGRvcyBhcnF1aXZvcyBDU1YgaW5kaXZpZHVhaXMuJ10pO1xyXG4gIH1cclxuICBcclxuICAvLyBBanVzdGFyIGxhcmd1cmEgZGFzIGNvbHVuYXNcclxuICB3b3Jrc2hlZXQuY29sdW1ucyA9IFtcclxuICAgIHsgd2lkdGg6IDE1IH0sIC8vIFZlbmNpbWVudG9cclxuICAgIHsgd2lkdGg6IDI1IH0sIC8vIFRyYW5zYWNpb25hZG9yXHJcbiAgICB7IHdpZHRoOiAxNSB9LCAvLyBEb2N1bWVudG9cclxuICAgIHsgd2lkdGg6IDE4IH0sIC8vIFZhbG9yXHJcbiAgICB7IHdpZHRoOiAxMiB9ICAvLyBUaXBvXHJcbiAgXTtcclxuICBcclxuICAvLyBBZGljaW9uYXIgYm9yZGFzIG5hcyBjw6lsdWxhcyBpbXBvcnRhbnRlc1xyXG4gIGNvbnN0IGFsbFJvd3MgPSB3b3Jrc2hlZXQuZ2V0Um93cygxLCB3b3Jrc2hlZXQucm93Q291bnQpO1xyXG4gIGFsbFJvd3M/LmZvckVhY2gocm93ID0+IHtcclxuICAgIHJvdy5lYWNoQ2VsbChjZWxsID0+IHtcclxuICAgICAgaWYgKGNlbGwudmFsdWUpIHtcclxuICAgICAgICBjZWxsLmJvcmRlciA9IHtcclxuICAgICAgICAgIHRvcDogeyBzdHlsZTogJ3RoaW4nIH0sXHJcbiAgICAgICAgICBsZWZ0OiB7IHN0eWxlOiAndGhpbicgfSxcclxuICAgICAgICAgIGJvdHRvbTogeyBzdHlsZTogJ3RoaW4nIH0sXHJcbiAgICAgICAgICByaWdodDogeyBzdHlsZTogJ3RoaW4nIH1cclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxufSJdLCJuYW1lcyI6WyJFeGNlbEpTIiwiaGVhZGVyU3R5bGUiLCJmb250IiwiYm9sZCIsImNvbG9yIiwiYXJnYiIsImZpbGwiLCJ0eXBlIiwicGF0dGVybiIsImZnQ29sb3IiLCJhbGlnbm1lbnQiLCJob3Jpem9udGFsIiwidmVydGljYWwiLCJib3JkZXIiLCJ0b3AiLCJzdHlsZSIsImxlZnQiLCJib3R0b20iLCJyaWdodCIsImNlbGxTdHlsZSIsInRpdGxlU3R5bGUiLCJzaXplIiwic3ViSGVhZGVyU3R5bGUiLCJ0b3RhbFJvd1N0eWxlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsImNvbnNvbGUiLCJsb2ciLCJtZXRob2QiLCJuYW1lIiwicmVwb3J0TmFtZSIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJjYXRlZ29yaWVzIiwiYm9keSIsInN1bW1hcnlEYXRhIiwiYWxsSW52b2ljZXMiLCJhbGxCcmFuY2hTdW1tYXJpZXMiLCJicmFuY2hlcyIsImxlbmd0aCIsInRvdGFsQVBhZ2FyIiwidG90YWxBUmVjZWJlciIsInRvdGFsIiwiZGF0ZVNwZWNpZmljVG90YWxzIiwiZGF5IiwiZ3JhbmRUb3RhbCIsImdyYW5kVG90YWxBUGFnYXIiLCJncmFuZFRvdGFsQVJlY2ViZXIiLCJnZW5lcmF0ZVNpbXVsYXRlZEludm9pY2VzIiwibWFwIiwiYnJhbmNoIiwiaW52b2ljZUNvdW50IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwidG90YWxWYWx1ZSIsInRvTG9jYWxlU3RyaW5nIiwiY3VycmVuY3kiLCJhY3R1YWxTdGFydERhdGUiLCJhY3R1YWxFbmREYXRlIiwiaW52b2ljZURhdGVzIiwiaW52IiwiRGF0ZSIsImRhdGUiLCJzb3J0IiwiYSIsImIiLCJnZXRUaW1lIiwid29ya2Jvb2siLCJXb3JrYm9vayIsImNyZWF0ZUFkdmFuY2VkU3VtbWFyeVdvcmtzaGVldCIsImJyYW5jaEludm9pY2VzIiwiZmlsdGVyIiwiY3JlYXRlQWR2YW5jZWRCcmFuY2hXb3Jrc2hlZXQiLCJmaWxlTmFtZSIsInRvSVNPU3RyaW5nIiwic3BsaXQiLCJzZXRIZWFkZXIiLCJ4bHN4Iiwid3JpdGUiLCJlbmQiLCJlcnJvciIsImhlYWRlcnNTZW50Iiwic3RhdHVzIiwianNvbiIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiRXJyb3IiLCJpbnZvaWNlcyIsImlkQ291bnRlciIsImZvckVhY2giLCJudW1JbnZvaWNlc0FQYWdhciIsImF2ZXJhZ2VWYWx1ZSIsImkiLCJ2YWx1ZSIsInNldERhdGUiLCJnZXREYXRlIiwicHVzaCIsImlkIiwiaW52b2ljZU51bWJlciIsIlN0cmluZyIsInBhZFN0YXJ0Iiwic3VwcGxpZXIiLCJmcm9tQ2hhckNvZGUiLCJkb2N1bWVudFR5cGUiLCJzb3VyY2VGaWxlIiwidmFsdWVOdW1lcmljIiwibnVtSW52b2ljZXNBUmVjZWJlciIsInN1bW1hcnlTaGVldCIsImFkZFdvcmtzaGVldCIsInN1bW1hcnlDdXJyZW50Um93IiwiYWRkUm93IiwibWVyZ2VDZWxscyIsImdldENlbGwiLCJnZXRSb3ciLCJoZWlnaHQiLCJwZXJpb2RUZXh0IiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwiZWFjaENlbGwiLCJjZWxsIiwiaW52b2ljZXNCeUZpbGVBbmRUeXBlIiwiTWFwIiwiaW52b2ljZSIsImhhcyIsInNldCIsIkFfUEFHQVIiLCJBX1JFQ0VCRVIiLCJmaWxlVHlwZXMiLCJnZXQiLCJkb2NUeXBlIiwiQXJyYXkiLCJmcm9tIiwiZmlsZUludm9pY2VzIiwiT2JqZWN0IiwiZW50cmllcyIsInR5cGVMYWJlbCIsImNsZWFuRmlsZU5hbWUiLCJyZXBsYWNlIiwiY3VycmVudERhdGUiLCJkYWlseVRvdGFsIiwiaW52b2ljZURhdGUiLCJpbnZvaWNlVmFsdWUiLCJ0b3RhbFJvdyIsImNvbE51bWJlciIsIm51bUZtdCIsInVuZGVmaW5lZCIsInJvdyIsImNhdGVnb3J5VG90YWwiLCJyZWR1Y2UiLCJzdW0iLCJjYXRlZ29yeVRvdGFsUm93IiwiZ3JhbmRUb3RhbFJvdyIsImdldENvbHVtbiIsIndpZHRoIiwiY2xlYW5CcmFuY2hOYW1lIiwic3Vic3RyaW5nIiwid29ya3NoZWV0IiwiY3VycmVudFJvdyIsInRpdGxlUm93IiwiYnJhbmNoRGF0ZXMiLCJyZXN1bW9Sb3ciLCJtaW5pbXVtRnJhY3Rpb25EaWdpdHMiLCJzYWxkb0xpcXVpZG8iLCJzYWxkb1JvdyIsInNhbGRvQ2VsbCIsImFwYWdhckludm9pY2VzIiwiYXJlY2ViZXJJbnZvaWNlcyIsImFQYWdhckhlYWRlclJvdyIsInRyYW5zSGVhZGVyUm93IiwidG90YWxBUGFnYXJSb3ciLCJhUmVjZWJlckhlYWRlclJvdyIsInRvdGFsQVJlY2ViZXJSb3ciLCJub0RhdGFSb3ciLCJjb2x1bW5zIiwiY3JlYXRlUmVzdW1vR2VyYWxXb3Jrc2hlZXQiLCJoZWFkZXJSb3ciLCJkYXRhUmFuZ2UiLCJnZXRSb3dzIiwicm93Q291bnQiLCJjcmVhdGVCcmFuY2hXb3Jrc2hlZXQiLCJwcm9jZXNzZWREYXRhIiwidHJhbnNhY3Rpb25zIiwidHJhbnNhY3Rpb25zSGVhZGVyUm93IiwidHJhbnNhY3Rpb24iLCJ0aXBvIiwidmFsb3JOdW1lcmljbyIsInZlbmNpbWVudG8iLCJ0cmFuc2FjaW9uYWRvciIsImRvY3VtZW50byIsInZhbG9yIiwiYWxsUm93cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/export-excel.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fexport-excel&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cexport-excel.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();